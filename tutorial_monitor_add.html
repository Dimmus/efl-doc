<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
"http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <title>eio_monitor_add() tutorial</title>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-110876574-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-110876574-1');
  </script>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <link rel="icon" href="favicon.png" type="image/x-icon">
  <link rel="shortcut icon" href="favicon.png" type="image/x-icon">
  <link rel="icon" href="favicon.png" type="image/ico">
  <link rel="shortcut icon" href="favicon.png" type="image/ico">
  <link rel="stylesheet" type="text/css" href="e.css">
</head>
<body>
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title"><a class="el" href="group__Eio__Monitor.html#gafa1136d1aac465a7e7b65e9ae36ed4e5" title="Adds a file/directory to monitor (inotify mechanism)">eio_monitor_add()</a> tutorial </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>To use <a class="el" href="group__Eio__Monitor.html#gafa1136d1aac465a7e7b65e9ae36ed4e5" title="Adds a file/directory to monitor (inotify mechanism)">eio_monitor_add()</a>, you have to define callbacks for events declared by eio.</p>
<p>Available events are :</p><ul>
<li>EIO_MONITOR_FILE_CREATED</li>
<li>EIO_MONITOR_FILE_DELETED</li>
<li>EIO_MONITOR_FILE_MODIFIED</li>
<li>EIO_MONITOR_FILE_CLOSED</li>
<li>EIO_MONITOR_DIRECTORY_CREATED</li>
<li>EIO_MONITOR_DIRECTORY_DELETED</li>
<li>EIO_MONITOR_DIRECTORY_CLOSED</li>
<li>EIO_MONITOR_SELF_RENAME</li>
<li>EIO_MONITOR_SELF_DELETED</li>
</ul>
<p>As nothing is worth an example, here it is : </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="Eina_8h.html">Eina.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;Ecore.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;Eio.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> file_modified(<span class="keywordtype">void</span> *data, <span class="keywordtype">int</span> type, <span class="keywordtype">void</span> *event)</div>
<div class="line">{</div>
<div class="line">   <span class="keyword">const</span> <span class="keywordtype">char</span> *filename = (<span class="keyword">const</span> <span class="keywordtype">char</span> *)data;</div>
<div class="line">   printf(<span class="stringliteral">&quot;file %s &quot;</span>, filename);</div>
<div class="line">   <span class="keywordflow">if</span>( type == <a class="code" href="group__Eio__Monitor.html#ga32f7035a95562b310b47f18c64d41703">EIO_MONITOR_FILE_MODIFIED</a> )</div>
<div class="line">      printf(<span class="stringliteral">&quot;is being modified&quot;</span>);</div>
<div class="line">   <span class="keywordflow">else</span> <span class="keywordflow">if</span>( type == <a class="code" href="group__Eio__Monitor.html#ga5120e3f3257f74bf664eaf91af85589f">EIO_MONITOR_FILE_CLOSED</a> )</div>
<div class="line">      printf(<span class="stringliteral">&quot;is no longer being modified&quot;</span>);</div>
<div class="line">   <span class="keywordflow">else</span> printf(<span class="stringliteral">&quot;got unexpected changes&quot;</span>);</div>
<div class="line">   printf(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv) {</div>
<div class="line">   Eio_Monitor *monitor  = NULL,</div>
<div class="line">               *monitor2 = NULL;</div>
<div class="line">   <a class="code" href="group__Eio__Helper.html#ga557c198fc1a90518d7872b77843fa029">eio_init</a>();</div>
<div class="line">   <span class="keyword">const</span> <span class="keywordtype">char</span> *filename = <a class="code" href="group__Eina__Stringshare__Group.html#ga21333851ab331b4d19d81bbef4996385">eina_stringshare_add</a>(<span class="stringliteral">&quot;/tmp/eio_notify_testfile&quot;</span>);</div>
<div class="line"> </div>
<div class="line">   monitor  = <a class="code" href="group__Eio__Monitor.html#gafa1136d1aac465a7e7b65e9ae36ed4e5">eio_monitor_add</a>(filename);</div>
<div class="line">   <a class="code" href="group__Ecore__Event__Group.html#gae75b0b1b2c50e73b8e42afc628b00a62">ecore_event_handler_add</a>(<a class="code" href="group__Eio__Monitor.html#ga32f7035a95562b310b47f18c64d41703">EIO_MONITOR_FILE_MODIFIED</a>, (<a class="code" href="group__Ecore__Event__Group.html#ga64b4df04cbafda481593d0bc29617c6d">Ecore_Event_Handler_Cb</a>)file_modified, filename);</div>
<div class="line">   <a class="code" href="group__Ecore__Event__Group.html#gae75b0b1b2c50e73b8e42afc628b00a62">ecore_event_handler_add</a>(<a class="code" href="group__Eio__Monitor.html#ga5120e3f3257f74bf664eaf91af85589f">EIO_MONITOR_FILE_CLOSED</a>, (<a class="code" href="group__Ecore__Event__Group.html#ga64b4df04cbafda481593d0bc29617c6d">Ecore_Event_Handler_Cb</a>)file_modified, filename);</div>
<div class="line"> </div>
<div class="line">   <a class="code" href="group__Ecore__Main__Loop__Group.html#gaf103b9f668bb3e4fed12e52c6180132d">ecore_main_loop_begin</a>();</div>
<div class="line">   <a class="code" href="group__Eio__Helper.html#ga7c3ad77c3f9a0346aab50f474af54b6c">eio_shutdown</a>();</div>
<div class="line">   <a class="code" href="group__Eina__Stringshare__Group.html#ga5538b4a134987b8a01744fad1a845ba4">eina_stringshare_del</a>(filename);</div>
<div class="line">}</div>
<div class="ttc" id="aEina_8h_html"><div class="ttname"><a href="Eina_8h.html">Eina.h</a></div><div class="ttdoc">Eina Utility library.</div></div>
<div class="ttc" id="agroup__Ecore__Event__Group_html_ga64b4df04cbafda481593d0bc29617c6d"><div class="ttname"><a href="group__Ecore__Event__Group.html#ga64b4df04cbafda481593d0bc29617c6d">Ecore_Event_Handler_Cb</a></div><div class="ttdeci">Eina_Bool(* Ecore_Event_Handler_Cb)(void *data, int type, void *event)</div><div class="ttdoc">A callback used by the main loop to handle events of a specified type.</div><div class="ttdef"><b>Definition:</b> Ecore_Common.h:603</div></div>
<div class="ttc" id="agroup__Ecore__Event__Group_html_gae75b0b1b2c50e73b8e42afc628b00a62"><div class="ttname"><a href="group__Ecore__Event__Group.html#gae75b0b1b2c50e73b8e42afc628b00a62">ecore_event_handler_add</a></div><div class="ttdeci">Ecore_Event_Handler * ecore_event_handler_add(int type, Ecore_Event_Handler_Cb func, const void *data)</div><div class="ttdoc">Adds an event handler.</div><div class="ttdef"><b>Definition:</b> ecore_events.c:13</div></div>
<div class="ttc" id="agroup__Ecore__Main__Loop__Group_html_gaf103b9f668bb3e4fed12e52c6180132d"><div class="ttname"><a href="group__Ecore__Main__Loop__Group.html#gaf103b9f668bb3e4fed12e52c6180132d">ecore_main_loop_begin</a></div><div class="ttdeci">void ecore_main_loop_begin(void)</div><div class="ttdoc">Runs the application main loop.</div><div class="ttdef"><b>Definition:</b> ecore_main.c:1311</div></div>
<div class="ttc" id="agroup__Eina__Stringshare__Group_html_ga21333851ab331b4d19d81bbef4996385"><div class="ttname"><a href="group__Eina__Stringshare__Group.html#ga21333851ab331b4d19d81bbef4996385">eina_stringshare_add</a></div><div class="ttdeci">EINA_API Eina_Stringshare * eina_stringshare_add(const char *str)</div><div class="ttdoc">Retrieves an instance of a string for use in a program.</div><div class="ttdef"><b>Definition:</b> eina_stringshare.c:606</div></div>
<div class="ttc" id="agroup__Eina__Stringshare__Group_html_ga5538b4a134987b8a01744fad1a845ba4"><div class="ttname"><a href="group__Eina__Stringshare__Group.html#ga5538b4a134987b8a01744fad1a845ba4">eina_stringshare_del</a></div><div class="ttdeci">EINA_API void eina_stringshare_del(Eina_Stringshare *str)</div><div class="ttdoc">Notes that the given string has lost an instance.</div><div class="ttdef"><b>Definition:</b> eina_stringshare.c:533</div></div>
<div class="ttc" id="agroup__Eio__Helper_html_ga557c198fc1a90518d7872b77843fa029"><div class="ttname"><a href="group__Eio__Helper.html#ga557c198fc1a90518d7872b77843fa029">eio_init</a></div><div class="ttdeci">EIO_API int eio_init(void)</div><div class="ttdoc">Initialize eio and all its required submodule.</div><div class="ttdef"><b>Definition:</b> eio_main.c:276</div></div>
<div class="ttc" id="agroup__Eio__Helper_html_ga7c3ad77c3f9a0346aab50f474af54b6c"><div class="ttname"><a href="group__Eio__Helper.html#ga7c3ad77c3f9a0346aab50f474af54b6c">eio_shutdown</a></div><div class="ttdeci">EIO_API int eio_shutdown(void)</div><div class="ttdoc">Shutdown eio and all its submodule if possible.</div><div class="ttdef"><b>Definition:</b> eio_main.c:340</div></div>
<div class="ttc" id="agroup__Eio__Monitor_html_ga32f7035a95562b310b47f18c64d41703"><div class="ttname"><a href="group__Eio__Monitor.html#ga32f7035a95562b310b47f18c64d41703">EIO_MONITOR_FILE_MODIFIED</a></div><div class="ttdeci">EIO_API int EIO_MONITOR_FILE_MODIFIED</div><div class="ttdoc">A file was modified in a watched directory.</div><div class="ttdef"><b>Definition:</b> eio_monitor.c:308</div></div>
<div class="ttc" id="agroup__Eio__Monitor_html_ga5120e3f3257f74bf664eaf91af85589f"><div class="ttname"><a href="group__Eio__Monitor.html#ga5120e3f3257f74bf664eaf91af85589f">EIO_MONITOR_FILE_CLOSED</a></div><div class="ttdeci">EIO_API int EIO_MONITOR_FILE_CLOSED</div><div class="ttdoc">A file was closed in a watched directory.</div><div class="ttdef"><b>Definition:</b> eio_monitor.c:309</div></div>
<div class="ttc" id="agroup__Eio__Monitor_html_gafa1136d1aac465a7e7b65e9ae36ed4e5"><div class="ttname"><a href="group__Eio__Monitor.html#gafa1136d1aac465a7e7b65e9ae36ed4e5">eio_monitor_add</a></div><div class="ttdeci">EIO_API Eio_Monitor * eio_monitor_add(const char *path)</div><div class="ttdoc">Adds a file/directory to monitor (inotify mechanism)</div><div class="ttdef"><b>Definition:</b> eio_monitor.c:318</div></div>
</div><!-- fragment --><p> Build the example doing : </p><pre class="fragment">gcc -o tutorial_monitor_add tutorial_monitor_add.c `pkg-config --libs --cflags eio ecore ecore-file eina`
* then create the file /tmp/eio_notify_testfile :
* touch /tmp/eio_notify_testfile
* and launch tutorial_monitor_add, and in another terminal, write into /tmp/eio_notify_testfile, doing for example :
* echo "test" &gt;&gt; /tmp/eio_notify_testfile
* </pre> </div></div><!-- contents -->
</div><!-- PageDoc -->
<div class="footer">
  <p>
    <span class="version">EFL 1.26.99</span>
    <span class="copyright">Copyright &copy;2000-2022 <a href="http://www.enlightenment.org">enlightenment.org</a></span>
    <span class="generated">Generated @ Sat Oct 29 2022 18:10:38</span>
  </p>
</div>
</body>
</html>
