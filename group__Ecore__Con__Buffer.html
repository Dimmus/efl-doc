<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
"http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <title>Ecore Connection Buffering</title>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-110876574-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-110876574-1');
  </script>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <link rel="icon" href="favicon.png" type="image/x-icon">
  <link rel="shortcut icon" href="favicon.png" type="image/x-icon">
  <link rel="icon" href="favicon.png" type="image/ico">
  <link rel="shortcut icon" href="favicon.png" type="image/ico">
  <link rel="stylesheet" type="text/css" href="e.css">
</head>
<body>
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Ecore Connection Buffering<div class="ingroups"><a class="el" href="group__Ecore.html">Ecore</a> &raquo; <a class="el" href="group__Ecore__Con__Group.html">Ecore_Con - Connection functions</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>As Ecore_Con works on an event driven design, as data arrives, events will be produced containing the data that arrived.  
</p>
<p>As Ecore_Con works on an event driven design, as data arrives, events will be produced containing the data that arrived. </p>
<p>It is up to the user of Ecore_Con to either parse as they go, append to a file to later parse the whole file in one go, or append to memory to parse or handle later.</p>
<p>To help with this Eina has some handy API's. The Eina_Binbuf and Eina_Strbuf APIs, abstract dynamic buffer management and make it trivial to handle buffers at runtime, without having to manage them. Eina_Binbuf makes it possible to create, expand, reset and slice a blob of memory - all via API. No system calls, no pointer manipulations and no size calculation.</p>
<p>Additional functions include adding content at specified byte positions in the buffer, escaping the inputs, find and replace strings. This provides extreme flexibility to play around, with a dynamic blob of memory.</p>
<p>It is good to free it (using <a class="el" href="group__Eina__Binary__Buffer__Group.html#ga9d4cb2aa16689f4388f082c18b0ac395" title="Frees a string buffer.">eina_binbuf_free()</a>) after using it.</p>
<p>Eina_Binbuf compliments Ecore_Con use cases, where dynamic sizes of data arrive from the network (think http download in chunks). Using Eina_Binbuf provides enough flexibility to handle data as it arrives and to defer its processing until desired, without having to think about where to store the temporary data and how to manage its size.</p>
<p>An example of how to use these with Ecore_Con follows.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="Eina_8h.html">Eina.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;Ecore.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;Ecore_Con.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <a class="code" href="group__Eina__Types__Group.html#ga3fe0caf72e93b1bab1ca8ee3ccf3f226">Eina_Bool</a></div>
<div class="line">data_callback(<span class="keywordtype">void</span> *data, <span class="keywordtype">int</span> type, <span class="keywordtype">void</span> *event)</div>
<div class="line">{</div>
<div class="line">   <a class="code" href="struct__Ecore__Con__Event__Url__Data.html">Ecore_Con_Event_Url_Data</a> *url_data = event;</div>
<div class="line">   <span class="keywordflow">if</span> ( url_data-&gt;<a class="code" href="struct__Ecore__Con__Event__Url__Data.html#a1d4725aa77f3875cc3405597a5fbff91">size</a> &gt; 0)</div>
<div class="line">     {</div>
<div class="line">        <span class="comment">// append data as it arrives - don&#39;t worry where or how it gets stored.</span></div>
<div class="line">        <span class="comment">// Also don&#39;t worry about size, expanding, reallocing etc.</span></div>
<div class="line">        <span class="comment">// just keep appending - size is automatically handled.</span></div>
<div class="line"> </div>
<div class="line">        <a class="code" href="group__Eina__Binary__Buffer__Group.html#gafed8f157ce1542b0e92fc6668649af08">eina_binbuf_append_length</a>(data, url_data-&gt;<a class="code" href="struct__Ecore__Con__Event__Url__Data.html#aaa4c4dbc6575b071164f8152a7808268">data</a>, url_data-&gt;<a class="code" href="struct__Ecore__Con__Event__Url__Data.html#a1d4725aa77f3875cc3405597a5fbff91">size</a>);</div>
<div class="line"> </div>
<div class="line">        fprintf(stderr, <span class="stringliteral">&quot;Appended %d \n&quot;</span>, url_data-&gt;<a class="code" href="struct__Ecore__Con__Event__Url__Data.html#a1d4725aa77f3875cc3405597a5fbff91">size</a>);</div>
<div class="line">     }</div>
<div class="line">   <span class="keywordflow">return</span> <a class="code" href="group__Eina__Types__Group.html#ga05c12dacc8b4058994df842b41be85fc">EINA_TRUE</a>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <a class="code" href="group__Eina__Types__Group.html#ga3fe0caf72e93b1bab1ca8ee3ccf3f226">Eina_Bool</a></div>
<div class="line">completion_callback(<span class="keywordtype">void</span> *data, <span class="keywordtype">int</span> type, <span class="keywordtype">void</span> *event)</div>
<div class="line">{</div>
<div class="line">   <a class="code" href="struct__Ecore__Con__Event__Url__Complete.html">Ecore_Con_Event_Url_Complete</a> *url_complete = event;</div>
<div class="line">   printf(<span class="stringliteral">&quot;download completed with status code: %d\n&quot;</span>, url_complete-&gt;<a class="code" href="struct__Ecore__Con__Event__Url__Complete.html#ab842caa1615a911c3578e0dfeae5f773">status</a>);</div>
<div class="line"> </div>
<div class="line">   <span class="comment">// get the data back from Eina_Binbuf</span></div>
<div class="line">   <span class="keywordtype">char</span> *ptr = <a class="code" href="group__Eina__Binary__Buffer__Group.html#ga12c4c95f602b8b38d2278ac6d347683f">eina_binbuf_string_get</a>(data);</div>
<div class="line">   <span class="keywordtype">size_t</span> size = <a class="code" href="group__Eina__Binary__Buffer__Group.html#ga70c8dfe71516ea732b4a168f658bcfb3">eina_binbuf_length_get</a>(data);</div>
<div class="line"> </div>
<div class="line">   <span class="comment">// process data as required (write to file)</span></div>
<div class="line">   fprintf(stderr, <span class="stringliteral">&quot;Size of data = %d bytes\n&quot;</span>, size);</div>
<div class="line">   <span class="keywordtype">int</span> fd = open(<span class="stringliteral">&quot;./elm.png&quot;</span>, O_CREAT);</div>
<div class="line">   write(fd, ptr, size);</div>
<div class="line">   close(fd);</div>
<div class="line"> </div>
<div class="line">   <span class="comment">// free it when done.</span></div>
<div class="line">   <a class="code" href="group__Eina__Binary__Buffer__Group.html#ga9d4cb2aa16689f4388f082c18b0ac395">eina_binbuf_free</a>(data);</div>
<div class="line"> </div>
<div class="line">   <a class="code" href="group__Ecore__Main__Loop__Group.html#ga95cf8e97dff0716433c2c5474d606a98">ecore_main_loop_quit</a>();</div>
<div class="line"> </div>
<div class="line">   <span class="keywordflow">return</span> <a class="code" href="group__Eina__Types__Group.html#ga05c12dacc8b4058994df842b41be85fc">EINA_TRUE</a>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line">   <span class="keyword">const</span> <span class="keywordtype">char</span> *url = <span class="stringliteral">&quot;http://www.enlightenment.org/p/index/d/logo.png&quot;</span>;</div>
<div class="line"> </div>
<div class="line">   <a class="code" href="group__Ecore__Init__Group.html#ga77757609684a2c922dc5ec398274751b">ecore_init</a>();</div>
<div class="line">   <a class="code" href="group__Ecore__Con__Lib__Group.html#ga8a20f47372627a03e86a8705a6f8a82d">ecore_con_init</a>();</div>
<div class="line">   <a class="code" href="group__Ecore__Con__Url__Group.html#ga96388997453269f58bde7873811af6d5">ecore_con_url_init</a>();</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">   <span class="comment">// This is single additional line to manage dynamic network data.</span></div>
<div class="line">   <a class="code" href="struct__Eina__Strbuf.html">Eina_Binbuf</a> *data = <a class="code" href="group__Eina__Binary__Buffer__Group.html#gab8fd509f70720ad16d768d959cb9d911">eina_binbuf_new</a>();</div>
<div class="line">   <a class="code" href="group__Ecore__Con__Url__Group.html#gad928193ae403bd05c1ce5ba48a1d52ea">Ecore_Con_Url</a> *url_con = <a class="code" href="group__Ecore__Con__Url__Group.html#ga71cce8e67deb5ea13d5f62d67d51ad9b">ecore_con_url_new</a>(url);</div>
<div class="line"> </div>
<div class="line">   <a class="code" href="group__Ecore__Event__Group.html#gae75b0b1b2c50e73b8e42afc628b00a62">ecore_event_handler_add</a>(<a class="code" href="group__Ecore__Con__Events__Group.html#gaa814f51fd5f97a92cdc76b624651d85a">ECORE_CON_EVENT_URL_COMPLETE</a>,</div>
<div class="line">                                                      completion_callback,</div>
<div class="line">                                                      data);</div>
<div class="line">   <a class="code" href="group__Ecore__Event__Group.html#gae75b0b1b2c50e73b8e42afc628b00a62">ecore_event_handler_add</a>(<a class="code" href="group__Ecore__Con__Events__Group.html#ga5affbb43768cd629c629d80afa2b5706">ECORE_CON_EVENT_URL_DATA</a>,</div>
<div class="line">                                                      data_callback,</div>
<div class="line">                                                      data);</div>
<div class="line">   <a class="code" href="group__Ecore__Con__Url__Group.html#gaeb79adc8f07e54ad7a87a8c55de5ec72">ecore_con_url_get</a>(url_con);</div>
<div class="line"> </div>
<div class="line">   <a class="code" href="group__Ecore__Main__Loop__Group.html#gaf103b9f668bb3e4fed12e52c6180132d">ecore_main_loop_begin</a>();</div>
<div class="line">   <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="aEina_8h_html"><div class="ttname"><a href="Eina_8h.html">Eina.h</a></div><div class="ttdoc">Eina Utility library.</div></div>
<div class="ttc" id="agroup__Ecore__Con__Events__Group_html_ga5affbb43768cd629c629d80afa2b5706"><div class="ttname"><a href="group__Ecore__Con__Events__Group.html#ga5affbb43768cd629c629d80afa2b5706">ECORE_CON_EVENT_URL_DATA</a></div><div class="ttdeci">ECORE_CON_API int ECORE_CON_EVENT_URL_DATA</div><div class="ttdoc">A URL object has data.</div><div class="ttdef"><b>Definition:</b> ecore_con_url.c:29</div></div>
<div class="ttc" id="agroup__Ecore__Con__Events__Group_html_gaa814f51fd5f97a92cdc76b624651d85a"><div class="ttname"><a href="group__Ecore__Con__Events__Group.html#gaa814f51fd5f97a92cdc76b624651d85a">ECORE_CON_EVENT_URL_COMPLETE</a></div><div class="ttdeci">ECORE_CON_API int ECORE_CON_EVENT_URL_COMPLETE</div><div class="ttdoc">A URL object has completed its transfer to and from the server and can be reused.</div><div class="ttdef"><b>Definition:</b> ecore_con_url.c:30</div></div>
<div class="ttc" id="agroup__Ecore__Con__Lib__Group_html_ga8a20f47372627a03e86a8705a6f8a82d"><div class="ttname"><a href="group__Ecore__Con__Lib__Group.html#ga8a20f47372627a03e86a8705a6f8a82d">ecore_con_init</a></div><div class="ttdeci">ECORE_CON_API int ecore_con_init(void)</div><div class="ttdoc">Initializes the Ecore_Con library.</div><div class="ttdef"><b>Definition:</b> ecore_con.c:68</div></div>
<div class="ttc" id="agroup__Ecore__Con__Url__Group_html_ga71cce8e67deb5ea13d5f62d67d51ad9b"><div class="ttname"><a href="group__Ecore__Con__Url__Group.html#ga71cce8e67deb5ea13d5f62d67d51ad9b">ecore_con_url_new</a></div><div class="ttdeci">ECORE_CON_API Ecore_Con_Url * ecore_con_url_new(const char *url)</div><div class="ttdoc">Creates and initializes a new Ecore_Con_Url connection object.</div><div class="ttdef"><b>Definition:</b> ecore_con_url.c:782</div></div>
<div class="ttc" id="agroup__Ecore__Con__Url__Group_html_ga96388997453269f58bde7873811af6d5"><div class="ttname"><a href="group__Ecore__Con__Url__Group.html#ga96388997453269f58bde7873811af6d5">ecore_con_url_init</a></div><div class="ttdeci">ECORE_CON_API int ecore_con_url_init(void)</div><div class="ttdoc">Initializes the Ecore_Con_Url library.</div><div class="ttdef"><b>Definition:</b> ecore_con_url.c:45</div></div>
<div class="ttc" id="agroup__Ecore__Con__Url__Group_html_gad928193ae403bd05c1ce5ba48a1d52ea"><div class="ttname"><a href="group__Ecore__Con__Url__Group.html#gad928193ae403bd05c1ce5ba48a1d52ea">Ecore_Con_Url</a></div><div class="ttdeci">struct _Ecore_Con_Url Ecore_Con_Url</div><div class="ttdoc">Used to provide legacy API/ABI compatibility with non-Eo applications.</div><div class="ttdef"><b>Definition:</b> Ecore_Con.h:323</div></div>
<div class="ttc" id="agroup__Ecore__Con__Url__Group_html_gaeb79adc8f07e54ad7a87a8c55de5ec72"><div class="ttname"><a href="group__Ecore__Con__Url__Group.html#gaeb79adc8f07e54ad7a87a8c55de5ec72">ecore_con_url_get</a></div><div class="ttdeci">ECORE_CON_API Eina_Bool ecore_con_url_get(Ecore_Con_Url *url_con)</div><div class="ttdoc">Sends a get request.</div><div class="ttdef"><b>Definition:</b> ecore_con_url.c:862</div></div>
<div class="ttc" id="agroup__Ecore__Event__Group_html_gae75b0b1b2c50e73b8e42afc628b00a62"><div class="ttname"><a href="group__Ecore__Event__Group.html#gae75b0b1b2c50e73b8e42afc628b00a62">ecore_event_handler_add</a></div><div class="ttdeci">Ecore_Event_Handler * ecore_event_handler_add(int type, Ecore_Event_Handler_Cb func, const void *data)</div><div class="ttdoc">Adds an event handler.</div><div class="ttdef"><b>Definition:</b> ecore_events.c:13</div></div>
<div class="ttc" id="agroup__Ecore__Init__Group_html_ga77757609684a2c922dc5ec398274751b"><div class="ttname"><a href="group__Ecore__Init__Group.html#ga77757609684a2c922dc5ec398274751b">ecore_init</a></div><div class="ttdeci">EAPI int ecore_init(void)</div><div class="ttdoc">Sets up connections, signal handlers, sockets etc.</div><div class="ttdef"><b>Definition:</b> ecore.c:230</div></div>
<div class="ttc" id="agroup__Ecore__Main__Loop__Group_html_ga95cf8e97dff0716433c2c5474d606a98"><div class="ttname"><a href="group__Ecore__Main__Loop__Group.html#ga95cf8e97dff0716433c2c5474d606a98">ecore_main_loop_quit</a></div><div class="ttdeci">void ecore_main_loop_quit(void)</div><div class="ttdoc">Quits the main loop once all the events currently on the queue have been processed.</div><div class="ttdef"><b>Definition:</b> ecore_main.c:1321</div></div>
<div class="ttc" id="agroup__Ecore__Main__Loop__Group_html_gaf103b9f668bb3e4fed12e52c6180132d"><div class="ttname"><a href="group__Ecore__Main__Loop__Group.html#gaf103b9f668bb3e4fed12e52c6180132d">ecore_main_loop_begin</a></div><div class="ttdeci">void ecore_main_loop_begin(void)</div><div class="ttdoc">Runs the application main loop.</div><div class="ttdef"><b>Definition:</b> ecore_main.c:1311</div></div>
<div class="ttc" id="agroup__Eina__Binary__Buffer__Group_html_ga12c4c95f602b8b38d2278ac6d347683f"><div class="ttname"><a href="group__Eina__Binary__Buffer__Group.html#ga12c4c95f602b8b38d2278ac6d347683f">eina_binbuf_string_get</a></div><div class="ttdeci">EINA_API const unsigned char * eina_binbuf_string_get(const Eina_Binbuf *buf)</div><div class="ttdoc">Retrieves a pointer to the contents of a string buffer.</div></div>
<div class="ttc" id="agroup__Eina__Binary__Buffer__Group_html_ga70c8dfe71516ea732b4a168f658bcfb3"><div class="ttname"><a href="group__Eina__Binary__Buffer__Group.html#ga70c8dfe71516ea732b4a168f658bcfb3">eina_binbuf_length_get</a></div><div class="ttdeci">EINA_API size_t eina_binbuf_length_get(const Eina_Binbuf *buf)</div><div class="ttdoc">Retrieves the length of the string buffer's content.</div></div>
<div class="ttc" id="agroup__Eina__Binary__Buffer__Group_html_ga9d4cb2aa16689f4388f082c18b0ac395"><div class="ttname"><a href="group__Eina__Binary__Buffer__Group.html#ga9d4cb2aa16689f4388f082c18b0ac395">eina_binbuf_free</a></div><div class="ttdeci">EINA_API void eina_binbuf_free(Eina_Binbuf *buf)</div><div class="ttdoc">Frees a string buffer.</div></div>
<div class="ttc" id="agroup__Eina__Binary__Buffer__Group_html_gab8fd509f70720ad16d768d959cb9d911"><div class="ttname"><a href="group__Eina__Binary__Buffer__Group.html#gab8fd509f70720ad16d768d959cb9d911">eina_binbuf_new</a></div><div class="ttdeci">EINA_API Eina_Binbuf * eina_binbuf_new(void)</div><div class="ttdoc">Creates a new binary string buffer.</div></div>
<div class="ttc" id="agroup__Eina__Binary__Buffer__Group_html_gafed8f157ce1542b0e92fc6668649af08"><div class="ttname"><a href="group__Eina__Binary__Buffer__Group.html#gafed8f157ce1542b0e92fc6668649af08">eina_binbuf_append_length</a></div><div class="ttdeci">EINA_API Eina_Bool eina_binbuf_append_length(Eina_Binbuf *buf, const unsigned char *str, size_t length)</div><div class="ttdoc">Appends a string of exact length to a buffer, reallocating as necessary.</div></div>
<div class="ttc" id="agroup__Eina__Types__Group_html_ga05c12dacc8b4058994df842b41be85fc"><div class="ttname"><a href="group__Eina__Types__Group.html#ga05c12dacc8b4058994df842b41be85fc">EINA_TRUE</a></div><div class="ttdeci">#define EINA_TRUE</div><div class="ttdoc">boolean value TRUE (numerical value 1)</div><div class="ttdef"><b>Definition:</b> eina_types.h:539</div></div>
<div class="ttc" id="agroup__Eina__Types__Group_html_ga3fe0caf72e93b1bab1ca8ee3ccf3f226"><div class="ttname"><a href="group__Eina__Types__Group.html#ga3fe0caf72e93b1bab1ca8ee3ccf3f226">Eina_Bool</a></div><div class="ttdeci">unsigned char Eina_Bool</div><div class="ttdoc">Type to mimic a boolean.</div><div class="ttdef"><b>Definition:</b> eina_types.h:527</div></div>
<div class="ttc" id="astruct__Ecore__Con__Event__Url__Complete_html"><div class="ttname"><a href="struct__Ecore__Con__Event__Url__Complete.html">_Ecore_Con_Event_Url_Complete</a></div><div class="ttdoc">Used as the data param for the ECORE_CON_EVENT_URL_COMPLETE event.</div><div class="ttdef"><b>Definition:</b> Ecore_Con.h:586</div></div>
<div class="ttc" id="astruct__Ecore__Con__Event__Url__Complete_html_ab842caa1615a911c3578e0dfeae5f773"><div class="ttname"><a href="struct__Ecore__Con__Event__Url__Complete.html#ab842caa1615a911c3578e0dfeae5f773">_Ecore_Con_Event_Url_Complete::status</a></div><div class="ttdeci">int status</div><div class="ttdoc">HTTP status code of the operation (200, 404, 401, etc.)</div><div class="ttdef"><b>Definition:</b> Ecore_Con.h:588</div></div>
<div class="ttc" id="astruct__Ecore__Con__Event__Url__Data_html"><div class="ttname"><a href="struct__Ecore__Con__Event__Url__Data.html">_Ecore_Con_Event_Url_Data</a></div><div class="ttdoc">Used as the data param for the ECORE_CON_EVENT_URL_DATA event.</div><div class="ttdef"><b>Definition:</b> Ecore_Con.h:574</div></div>
<div class="ttc" id="astruct__Ecore__Con__Event__Url__Data_html_a1d4725aa77f3875cc3405597a5fbff91"><div class="ttname"><a href="struct__Ecore__Con__Event__Url__Data.html#a1d4725aa77f3875cc3405597a5fbff91">_Ecore_Con_Event_Url_Data::size</a></div><div class="ttdeci">int size</div><div class="ttdoc">the size of the current received data (in bytes)</div><div class="ttdef"><b>Definition:</b> Ecore_Con.h:576</div></div>
<div class="ttc" id="astruct__Ecore__Con__Event__Url__Data_html_aaa4c4dbc6575b071164f8152a7808268"><div class="ttname"><a href="struct__Ecore__Con__Event__Url__Data.html#aaa4c4dbc6575b071164f8152a7808268">_Ecore_Con_Event_Url_Data::data</a></div><div class="ttdeci">unsigned char data[1]</div><div class="ttdoc">the data received on this event</div><div class="ttdef"><b>Definition:</b> Ecore_Con.h:577</div></div>
<div class="ttc" id="astruct__Eina__Strbuf_html"><div class="ttname"><a href="struct__Eina__Strbuf.html">_Eina_Strbuf</a></div><div class="ttdoc">String buffer to facilitate string operations.</div><div class="ttdef"><b>Definition:</b> eina_strbuf_common.h:15</div></div>
</div><!-- fragment --> </div><!-- contents -->
<div class="footer">
  <p>
    <span class="version">EFL 1.26.99</span>
    <span class="copyright">Copyright &copy;2000-2022 <a href="http://www.enlightenment.org">enlightenment.org</a></span>
    <span class="generated">Generated @ Sat Oct 29 2022 18:10:49</span>
  </p>
</div>
</body>
</html>
