<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
"http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <title>Eina Promises</title>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-110876574-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-110876574-1');
  </script>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <link rel="icon" href="favicon.png" type="image/x-icon">
  <link rel="shortcut icon" href="favicon.png" type="image/x-icon">
  <link rel="icon" href="favicon.png" type="image/ico">
  <link rel="shortcut icon" href="favicon.png" type="image/ico">
  <link rel="stylesheet" type="text/css" href="e.css">
</head>
<body>
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#groups">Modules</a> &#124;
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">Eina Promises<div class="ingroups"><a class="el" href="group__Eina.html">Eina</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Promises are a programming paradigm that simplifies synchronization when concurrent execution is present.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="groups"></a>
Modules</h2></td></tr>
<tr class="memitem:group__Eina__Future"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Eina__Future.html">Eina Futures</a></td></tr>
<tr class="memdesc:group__Eina__Future"><td class="mdescLeft">&#160;</td><td class="mdescRight">Methods and structures dealing with <a class="el" href="structEina__Future.html" title="An opaque structure representing a callback to be called when a promise is fulfilled.">Eina_Future</a>. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structEina__Promise.html">Eina_Promise</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">An opaque structure representing a piece of data that will be available at a later point.  <a href="structEina__Promise.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga869bfac6443a0a0209057e87da1a79c5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__Eina__Types__Group.html#ga6ac08753ba12bc9c7a0390cf67868f4f">EINA_API</a> <a class="el" href="structEina__Promise.html">Eina_Promise</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Eina__Promise.html#ga869bfac6443a0a0209057e87da1a79c5">eina_promise_new</a> (<a class="el" href="group__Eina__Future__Callbacks.html#ga190fb0e75b86d093db85b05abfd21ebd">Eina_Future_Scheduler</a> *scheduler, <a class="el" href="group__Eina__Future__Callbacks.html#gab618b4d7aef449893108219332d8a85e">Eina_Promise_Cancel_Cb</a> cancel_cb, const void *data)</td></tr>
<tr class="memdesc:ga869bfac6443a0a0209057e87da1a79c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a new promise.  <a href="group__Eina__Promise.html#ga869bfac6443a0a0209057e87da1a79c5">More...</a><br /></td></tr>
<tr class="separator:ga869bfac6443a0a0209057e87da1a79c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5ae6d1590598ba59014e00e4d5b85d82"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__Eina__Types__Group.html#ga6ac08753ba12bc9c7a0390cf67868f4f">EINA_API</a> <a class="el" href="structEina__Promise.html">Eina_Promise</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Eina__Promise.html#ga5ae6d1590598ba59014e00e4d5b85d82">eina_promise_continue_new</a> (const <a class="el" href="structEina__Future.html">Eina_Future</a> *dead_future, <a class="el" href="group__Eina__Future__Callbacks.html#gab618b4d7aef449893108219332d8a85e">Eina_Promise_Cancel_Cb</a> cancel_cb, const void *data)</td></tr>
<tr class="memdesc:ga5ae6d1590598ba59014e00e4d5b85d82"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a new promise from a dead_future.  <a href="group__Eina__Promise.html#ga5ae6d1590598ba59014e00e4d5b85d82">More...</a><br /></td></tr>
<tr class="separator:ga5ae6d1590598ba59014e00e4d5b85d82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga231f1e09741f0cb0e9ceeef15cf4e4ee"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__Eina__Types__Group.html#ga6ac08753ba12bc9c7a0390cf67868f4f">EINA_API</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Eina__Promise.html#ga231f1e09741f0cb0e9ceeef15cf4e4ee">eina_promise_resolve</a> (<a class="el" href="structEina__Promise.html">Eina_Promise</a> *p, <a class="el" href="group__Eina__Value__Group.html#ga7985e8af6e956ae31b381bf829173cc0">Eina_Value</a> value)</td></tr>
<tr class="memdesc:ga231f1e09741f0cb0e9ceeef15cf4e4ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resolves a promise.  <a href="group__Eina__Promise.html#ga231f1e09741f0cb0e9ceeef15cf4e4ee">More...</a><br /></td></tr>
<tr class="separator:ga231f1e09741f0cb0e9ceeef15cf4e4ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga33c04f489c071e795839cbf6e60566ba"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__Eina__Types__Group.html#ga6ac08753ba12bc9c7a0390cf67868f4f">EINA_API</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Eina__Promise.html#ga33c04f489c071e795839cbf6e60566ba">eina_promise_reject</a> (<a class="el" href="structEina__Promise.html">Eina_Promise</a> *p, <a class="el" href="group__Eina__Error__Group.html#ga95b3cbb33e987e7d92a81ea785001686">Eina_Error</a> err)</td></tr>
<tr class="memdesc:ga33c04f489c071e795839cbf6e60566ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rejects a promise.  <a href="group__Eina__Promise.html#ga33c04f489c071e795839cbf6e60566ba">More...</a><br /></td></tr>
<tr class="separator:ga33c04f489c071e795839cbf6e60566ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ga20f8b1103ee569060834d1dc3ab5f401"><td class="memItemLeft" align="right" valign="top"><a id="ga20f8b1103ee569060834d1dc3ab5f401"></a>
<a class="el" href="group__Eina__Types__Group.html#ga6ac08753ba12bc9c7a0390cf67868f4f">EINA_API</a> const <a class="el" href="group__Eina__Value__Group.html#gaab67ab8bcd0624280c5276044b07e0d2">Eina_Value_Type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Eina__Promise.html#ga20f8b1103ee569060834d1dc3ab5f401">EINA_VALUE_TYPE_PROMISE</a></td></tr>
<tr class="memdesc:ga20f8b1103ee569060834d1dc3ab5f401"><td class="mdescLeft">&#160;</td><td class="mdescRight">Value type for <a class="el" href="group__Eina__Value__Group.html#ga7985e8af6e956ae31b381bf829173cc0" title="Store generic values.">Eina_Value</a>'s containing an <a class="el" href="structEina__Promise.html" title="An opaque structure representing a piece of data that will be available at a later point.">Eina_Promise</a>. <br /></td></tr>
<tr class="separator:ga20f8b1103ee569060834d1dc3ab5f401"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Promises are a programming paradigm that simplifies synchronization when concurrent execution is present. </p>
<p>Since C does not natively support Promises the Eina library provides the <a class="el" href="structEina__Promise.html" title="An opaque structure representing a piece of data that will be available at a later point.">Eina_Promise</a> and <a class="el" href="structEina__Future.html" title="An opaque structure representing a callback to be called when a promise is fulfilled.">Eina_Future</a> objects.</p>
<p>In procedural languages like C if you need a value which is not yet available, for instance because it takes a long time to calculate or has to be fetched from a remote server, you typically have to wait.</p>
<p>Other languages however can return a Promise and continue execution immediately. A promise acts as a placeholder for the requested value: the value is not available yet but will be at some point in the future.</p>
<p>With a promise in hand you can attach callbacks to be triggered when the value becomes available (i.e. when the promise is fulfilled) and then continue your calculations. You can even pass the promise to other methods which will then be executed as values become available, forming complex chains.</p>
<p>An <a class="el" href="structEina__Promise.html" title="An opaque structure representing a piece of data that will be available at a later point.">Eina_Promise</a> can be considered as an object with the sole purpose of emitting the "Promise Resolved" event. <a class="el" href="structEina__Future.html" title="An opaque structure representing a callback to be called when a promise is fulfilled.">Eina_Future</a> are callbacks attached to this object to be called when the event is emitted. The promised value is passed to the callbacks whenever it's available.</p>
<p>Here's a typical example:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;Ecore.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">_promise_cancel(<span class="keywordtype">void</span> *data, <a class="code" href="structEina__Promise.html">Eina_Promise</a> *p <a class="code" href="group__Eina__Types__Group.html#ga82d751be730f849719ca292f9558be87">EINA_UNUSED</a>)</div>
<div class="line">{</div>
<div class="line">  Ctx *ctx = data;</div>
<div class="line">  <span class="comment">// In case the promise is canceled we must stop the timer!</span></div>
<div class="line">  <a class="code" href="group__Ecore__Timer__Group.html#gaba2b599c7aabe3ab664dc3d47f62a33a">ecore_timer_del</a>(ctx-&gt;timer);</div>
<div class="line">  free(ctx);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <a class="code" href="group__Eina__Types__Group.html#ga3fe0caf72e93b1bab1ca8ee3ccf3f226">Eina_Bool</a></div>
<div class="line">_promise_resolve(<span class="keywordtype">void</span> *data)</div>
<div class="line">{</div>
<div class="line">   Ctx *ctx = data;</div>
<div class="line">   <a class="code" href="struct__Eina__Value.html">Eina_Value</a> v;</div>
<div class="line">   <a class="code" href="group__Eina__Value__Value__Group.html#gab5c6558b1b8be2ad597d71a765cbf5f6">eina_value_setup</a>(&amp;v, <a class="code" href="group__Eina__Value__Group.html#ga916f76c8d5ffd4c3ee3c322a54efd0b7">EINA_VALUE_TYPE_STRING</a>);</div>
<div class="line">   <a class="code" href="group__Eina__Value__Value__Group.html#ga9a1407c953694c3d6f40ab01ebe9a294">eina_value_set</a>(&amp;v, <span class="stringliteral">&quot;Promise resolved&quot;</span>);</div>
<div class="line">   <a class="code" href="group__Eina__Promise.html#ga231f1e09741f0cb0e9ceeef15cf4e4ee">eina_promise_resolve</a>(ctx-&gt;p, v);</div>
<div class="line">   free(ctx);</div>
<div class="line">   <span class="keywordflow">return</span> <a class="code" href="group__Eina__Types__Group.html#ga1feb115f8e9913e806e090d9bd5a7301">EINA_FALSE</a>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="structEina__Promise.html">Eina_Promise</a> *</div>
<div class="line">promise_create(<a class="code" href="struct__Eina__Future__Scheduler.html">Eina_Future_Scheduler</a> *scheduler)</div>
<div class="line">{</div>
<div class="line">   Ctx *ctx = malloc(<span class="keyword">sizeof</span>(Ctx));</div>
<div class="line">   <span class="comment">// A timer is scheduled in order to resolve the promise</span></div>
<div class="line">   ctx-&gt;timer = <a class="code" href="group__Ecore__Timer__Group.html#ga7b9cb9d24ecebfdbb957436e2e669402">ecore_timer_add</a>(122, _promise_resolve, ctx);</div>
<div class="line">   <span class="comment">// The _promise_cancel() will be used to clean ctx if the promise is canceled.</span></div>
<div class="line">   ctx-&gt;p = <a class="code" href="group__Eina__Promise.html#ga869bfac6443a0a0209057e87da1a79c5">eina_promise_new</a>(scheduler, _promise_cancel, ctx);</div>
<div class="line">   <span class="keywordflow">return</span> ctx-&gt;p;</div>
<div class="line">}</div>
<div class="ttc" id="agroup__Ecore__Timer__Group_html_ga7b9cb9d24ecebfdbb957436e2e669402"><div class="ttname"><a href="group__Ecore__Timer__Group.html#ga7b9cb9d24ecebfdbb957436e2e669402">ecore_timer_add</a></div><div class="ttdeci">Ecore_Timer * ecore_timer_add(double in, Ecore_Task_Cb func, const void *data)</div><div class="ttdoc">Creates a timer to call the given function in the given period of time.</div><div class="ttdef"><b>Definition:</b> ecore_timer.c:189</div></div>
<div class="ttc" id="agroup__Ecore__Timer__Group_html_gaba2b599c7aabe3ab664dc3d47f62a33a"><div class="ttname"><a href="group__Ecore__Timer__Group.html#gaba2b599c7aabe3ab664dc3d47f62a33a">ecore_timer_del</a></div><div class="ttdeci">void * ecore_timer_del(Ecore_Timer *timer)</div><div class="ttdoc">Deletes the specified timer from the timer list.</div><div class="ttdef"><b>Definition:</b> ecore_timer.c:238</div></div>
<div class="ttc" id="agroup__Eina__Promise_html_ga231f1e09741f0cb0e9ceeef15cf4e4ee"><div class="ttname"><a href="group__Eina__Promise.html#ga231f1e09741f0cb0e9ceeef15cf4e4ee">eina_promise_resolve</a></div><div class="ttdeci">EINA_API void eina_promise_resolve(Eina_Promise *p, Eina_Value value)</div><div class="ttdoc">Resolves a promise.</div><div class="ttdef"><b>Definition:</b> eina_promise.c:788</div></div>
<div class="ttc" id="agroup__Eina__Promise_html_ga869bfac6443a0a0209057e87da1a79c5"><div class="ttname"><a href="group__Eina__Promise.html#ga869bfac6443a0a0209057e87da1a79c5">eina_promise_new</a></div><div class="ttdeci">EINA_API Eina_Promise * eina_promise_new(Eina_Future_Scheduler *scheduler, Eina_Promise_Cancel_Cb cancel_cb, const void *data)</div><div class="ttdoc">Creates a new promise.</div><div class="ttdef"><b>Definition:</b> eina_promise.c:743</div></div>
<div class="ttc" id="agroup__Eina__Types__Group_html_ga1feb115f8e9913e806e090d9bd5a7301"><div class="ttname"><a href="group__Eina__Types__Group.html#ga1feb115f8e9913e806e090d9bd5a7301">EINA_FALSE</a></div><div class="ttdeci">#define EINA_FALSE</div><div class="ttdoc">boolean value FALSE (numerical value 0)</div><div class="ttdef"><b>Definition:</b> eina_types.h:533</div></div>
<div class="ttc" id="agroup__Eina__Types__Group_html_ga3fe0caf72e93b1bab1ca8ee3ccf3f226"><div class="ttname"><a href="group__Eina__Types__Group.html#ga3fe0caf72e93b1bab1ca8ee3ccf3f226">Eina_Bool</a></div><div class="ttdeci">unsigned char Eina_Bool</div><div class="ttdoc">Type to mimic a boolean.</div><div class="ttdef"><b>Definition:</b> eina_types.h:527</div></div>
<div class="ttc" id="agroup__Eina__Types__Group_html_ga82d751be730f849719ca292f9558be87"><div class="ttname"><a href="group__Eina__Types__Group.html#ga82d751be730f849719ca292f9558be87">EINA_UNUSED</a></div><div class="ttdeci">#define EINA_UNUSED</div><div class="ttdoc">Used to indicate that a function parameter is purposely unused.</div><div class="ttdef"><b>Definition:</b> eina_types.h:339</div></div>
<div class="ttc" id="agroup__Eina__Value__Group_html_ga916f76c8d5ffd4c3ee3c322a54efd0b7"><div class="ttname"><a href="group__Eina__Value__Group.html#ga916f76c8d5ffd4c3ee3c322a54efd0b7">EINA_VALUE_TYPE_STRING</a></div><div class="ttdeci">EINA_API const Eina_Value_Type * EINA_VALUE_TYPE_STRING</div><div class="ttdoc">manages string type.</div><div class="ttdef"><b>Definition:</b> eina_value.c:5608</div></div>
<div class="ttc" id="agroup__Eina__Value__Value__Group_html_ga9a1407c953694c3d6f40ab01ebe9a294"><div class="ttname"><a href="group__Eina__Value__Value__Group.html#ga9a1407c953694c3d6f40ab01ebe9a294">eina_value_set</a></div><div class="ttdeci">static Eina_Bool eina_value_set(Eina_Value *value,...)</div><div class="ttdoc">Sets the generic value.</div></div>
<div class="ttc" id="agroup__Eina__Value__Value__Group_html_gab5c6558b1b8be2ad597d71a765cbf5f6"><div class="ttname"><a href="group__Eina__Value__Value__Group.html#gab5c6558b1b8be2ad597d71a765cbf5f6">eina_value_setup</a></div><div class="ttdeci">static Eina_Bool eina_value_setup(Eina_Value *value, const Eina_Value_Type *type)</div><div class="ttdoc">Initializes generic value storage.</div></div>
<div class="ttc" id="astructEina__Promise_html"><div class="ttname"><a href="structEina__Promise.html">Eina_Promise</a></div><div class="ttdoc">An opaque structure representing a piece of data that will be available at a later point.</div></div>
<div class="ttc" id="astruct__Eina__Future__Scheduler_html"><div class="ttname"><a href="struct__Eina__Future__Scheduler.html">_Eina_Future_Scheduler</a></div><div class="ttdoc">This struct is used as a bridge between Eina and the future scheduler.</div><div class="ttdef"><b>Definition:</b> eina_promise.h:165</div></div>
<div class="ttc" id="astruct__Eina__Value_html"><div class="ttname"><a href="struct__Eina__Value.html">_Eina_Value</a></div><div class="ttdoc">defines the contents of a value</div><div class="ttdef"><b>Definition:</b> eina_value.h:662</div></div>
</div><!-- fragment --> <h2 class="groupheader">Function Documentation</h2>
<a id="ga869bfac6443a0a0209057e87da1a79c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga869bfac6443a0a0209057e87da1a79c5">&#9670;&nbsp;</a></span>eina_promise_new()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__Eina__Types__Group.html#ga6ac08753ba12bc9c7a0390cf67868f4f">EINA_API</a> <a class="el" href="structEina__Promise.html">Eina_Promise</a>* eina_promise_new </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__Eina__Future__Callbacks.html#ga190fb0e75b86d093db85b05abfd21ebd">Eina_Future_Scheduler</a> *&#160;</td>
          <td class="paramname"><em>scheduler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__Eina__Future__Callbacks.html#gab618b4d7aef449893108219332d8a85e">Eina_Promise_Cancel_Cb</a>&#160;</td>
          <td class="paramname"><em>cancel_cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a new promise. </p>
<p>This function creates a new promise which can be used to create a future using <a class="el" href="group__Eina__Future.html#ga2a96213437a53d5fedd0fe57541d27b3" title="Creates a new future.">eina_future_new()</a>. Every time a promise is created an <a class="el" href="group__Eina__Future__Callbacks.html#gab618b4d7aef449893108219332d8a85e" title="A callback used to inform that a promise was canceled.">Eina_Promise_Cancel_Cb</a> must be provided which is used to free resources that were created.</p>
<p>A promise may be canceled directly by calling: </p><div class="fragment"><div class="line"><a class="code" href="group__Eina__Future.html#ga5462a38eabc060b163d24c9d7395ae3b">eina_future_cancel</a>(<a class="code" href="group__Eina__Future.html#ga2a96213437a53d5fedd0fe57541d27b3">eina_future_new</a>(<a class="code" href="group__Eina__Promise.html#ga869bfac6443a0a0209057e87da1a79c5">eina_promise_new</a>(...)))</div>
<div class="ttc" id="agroup__Eina__Future_html_ga2a96213437a53d5fedd0fe57541d27b3"><div class="ttname"><a href="group__Eina__Future.html#ga2a96213437a53d5fedd0fe57541d27b3">eina_future_new</a></div><div class="ttdeci">EINA_API Eina_Future * eina_future_new(Eina_Promise *p)</div><div class="ttdoc">Creates a new future.</div><div class="ttdef"><b>Definition:</b> eina_promise.c:867</div></div>
<div class="ttc" id="agroup__Eina__Future_html_ga5462a38eabc060b163d24c9d7395ae3b"><div class="ttname"><a href="group__Eina__Future.html#ga5462a38eabc060b163d24c9d7395ae3b">eina_future_cancel</a></div><div class="ttdeci">EINA_API void eina_future_cancel(Eina_Future *f)</div><div class="ttdoc">Cancels a future.</div><div class="ttdef"><b>Definition:</b> eina_promise.c:781</div></div>
</div><!-- fragment --><p> That is, canceling any future that is chained to receive the results.</p>
<p>However promises can be canceled indirectly by other entities. These other entities will call <a class="el" href="group__Eina__Future.html#ga5462a38eabc060b163d24c9d7395ae3b" title="Cancels a future.">eina_future_cancel()</a> themselves, however you may not be aware of that. Some common sources of indirect cancellations:</p>
<ul>
<li>A subsystem was shutdown, canceling all pending futures (i.e.: <a class="el" href="group__Ecore__Init__Group.html#ga768298b932f18d7e7593a447493e5cde" title="Shuts down connections, signal handlers sockets etc.">ecore_shutdown()</a>)</li>
</ul>
<ul>
<li>An EO object was linked to the promise or future, then if the object dies (last reference is gone), then the pending promises and futures will be canceled.</li>
</ul>
<ul>
<li>Some other entity (library provider or library user) chained and canceled his future, which will result in your future being canceled.</li>
</ul>
<p>Since a promise may be canceled indirectly (by code sections that goes beyond your scope) you should always provide a cancel callback, even if you think you'll not need it.</p>
<p>If you already have a value and want to create a future that will resolve to it directly use the <a class="el" href="group__Eina__Future.html#ga09fbe25c39fe21ec2a8171b09330e0cd" title="Creates a new future that is already resolved to a value.">eina_future_resolved()</a>, it has the same effect as creating a promise and immediately resolving it.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">scheduler</td><td>The scheduler. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cancel_cb</td><td>A callback used to inform that the promise was canceled. Use this callback to <code>free</code> <code>data</code>. <code>cancel_cb</code> must not be <code>NULL</code> ! </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>Data to <code>cancel_cb</code>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A promise or <code>NULL</code> on error. </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__Eina__Future.html#ga5462a38eabc060b163d24c9d7395ae3b" title="Cancels a future.">eina_future_cancel()</a> </dd>
<dd>
<a class="el" href="group__Eina__Future.html#ga2a96213437a53d5fedd0fe57541d27b3" title="Creates a new future.">eina_future_new()</a> </dd>
<dd>
<a class="el" href="group__Eina__Promise.html#ga5ae6d1590598ba59014e00e4d5b85d82" title="Creates a new promise from a dead_future.">eina_promise_continue_new()</a> </dd>
<dd>
<a class="el" href="group__Eina__Promise.html#ga231f1e09741f0cb0e9ceeef15cf4e4ee" title="Resolves a promise.">eina_promise_resolve()</a> </dd>
<dd>
<a class="el" href="group__Eina__Promise.html#ga33c04f489c071e795839cbf6e60566ba" title="Rejects a promise.">eina_promise_reject()</a> </dd>
<dd>
<a class="el" href="group__Eina__Future.html#gab966fb4259f6c1d0f18840e31213a26a" title="Creates a new Eina_Value from a promise.">eina_promise_as_value()</a> </dd>
<dd>
<a class="el" href="group__Eina__Future__Callbacks.html#ga190fb0e75b86d093db85b05abfd21ebd" title="Convenience wrapper over _Eina_Future_Scheduler.">Eina_Future_Scheduler</a> </dd>
<dd>
<a class="el" href="group__Eina__Future__Callbacks.html#ga8ecbf4d4816b354fad992cd5874c656a" title="Convenience wrapper over _Eina_Future_Schedule_Entry.">Eina_Future_Schedule_Entry</a> </dd>
<dd>
<a class="el" href="group__Eina__Future__Callbacks.html#gac685b488df7948131b6405451d0b4fb5" title="A callback used by the Eina_Future_Scheduler to deliver the future operation result.">Eina_Future_Scheduler_Cb</a> </dd></dl>

<p class="reference">References <a class="el" href="group__Eina__File__Group.html#gae8924623ca601364965e3d88fb7f40fa">DBG</a>, <a class="el" href="group__Eina__Memory__Pool__Group.html#gab9f29782c01cb62d2b70bc65c6fa5e1b">eina_mempool_calloc()</a>, <a class="el" href="group__Eina__Safety__Checks__Group.html#gab2b07061fc6500dedd9cd41c8d16f95d">EINA_SAFETY_ON_NULL_RETURN_VAL</a>, <a class="el" href="struct__Eina__Future__Scheduler.html#ad7e267c5652f88e78c3d1c4ac82d1e09">_Eina_Future_Scheduler::recall</a>, and <a class="el" href="struct__Eina__Future__Scheduler.html#ae38d236f08c2a13fa318cd66e8460ede">_Eina_Future_Scheduler::schedule</a>.</p>

<p class="reference">Referenced by <a class="el" href="group__Eina__Future.html#ga59277c714beab7a5231f014d4eed2670">eina_future_as_value()</a>, <a class="el" href="group__Eina__Future.html#ga6e03afecb9d4fa426cb6563805069818">eina_future_rejected()</a>, <a class="el" href="group__Eina__Future.html#ga09fbe25c39fe21ec2a8171b09330e0cd">eina_future_resolved()</a>, and <a class="el" href="group__Eina__Future.html#gade7b30161feaf75b5f1a05843719d523">eina_promise_all_iterator()</a>.</p>

</div>
</div>
<a id="ga5ae6d1590598ba59014e00e4d5b85d82"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5ae6d1590598ba59014e00e4d5b85d82">&#9670;&nbsp;</a></span>eina_promise_continue_new()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__Eina__Types__Group.html#ga6ac08753ba12bc9c7a0390cf67868f4f">EINA_API</a> <a class="el" href="structEina__Promise.html">Eina_Promise</a>* eina_promise_continue_new </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structEina__Future.html">Eina_Future</a> *&#160;</td>
          <td class="paramname"><em>dead_future</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__Eina__Future__Callbacks.html#gab618b4d7aef449893108219332d8a85e">Eina_Promise_Cancel_Cb</a>&#160;</td>
          <td class="paramname"><em>cancel_cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a new promise from a dead_future. </p>
<p>This function creates a new promise from a future currently being resolved which can be used to create a <a class="el" href="group__Eina__Value__Group.html#ga7985e8af6e956ae31b381bf829173cc0" title="Store generic values.">Eina_Value</a> with <a class="el" href="group__Eina__Future.html#gab966fb4259f6c1d0f18840e31213a26a" title="Creates a new Eina_Value from a promise.">eina_promise_as_value()</a>. Every time a promise is created an <a class="el" href="group__Eina__Future__Callbacks.html#gab618b4d7aef449893108219332d8a85e" title="A callback used to inform that a promise was canceled.">Eina_Promise_Cancel_Cb</a> must be provided which is used to free resources that were created.</p>
<p>A promise may be canceled directly by calling: </p><div class="fragment"><div class="line"><a class="code" href="group__Eina__Future.html#ga5462a38eabc060b163d24c9d7395ae3b">eina_future_cancel</a>(<a class="code" href="group__Eina__Future.html#ga2a96213437a53d5fedd0fe57541d27b3">eina_future_new</a>(<a class="code" href="group__Eina__Promise.html#ga869bfac6443a0a0209057e87da1a79c5">eina_promise_new</a>(...)))</div>
</div><!-- fragment --><p> That is, canceling any future that is chained to receive the results.</p>
<p>However promises can be canceled indirectly by other entities. These other entities will call <a class="el" href="group__Eina__Future.html#ga5462a38eabc060b163d24c9d7395ae3b" title="Cancels a future.">eina_future_cancel()</a> themselves, however you may not be aware of that. Some common sources of indirect cancellations:</p>
<ul>
<li>A subsystem was shutdown, canceling all pending futures (i.e.: <a class="el" href="group__Ecore__Init__Group.html#ga768298b932f18d7e7593a447493e5cde" title="Shuts down connections, signal handlers sockets etc.">ecore_shutdown()</a>)</li>
</ul>
<ul>
<li>An EO object was linked to the promise or future, then if the object dies (last reference is gone), then the pending promises and futures will be canceled.</li>
</ul>
<ul>
<li>Some other entity (library provider or library user) chained and canceled his future, which will result in your future being canceled.</li>
</ul>
<p>Since a promise may be canceled indirectly (by code sections that goes beyond your scope) you should always provide a cancel callback, even if you think you'll not need it.</p>
<p>Here's a typical example:</p>
<div class="fragment"><div class="line"><a class="code" href="struct__Eina__Value.html">Eina_Value</a></div>
<div class="line">_future_resolve(<span class="keywordtype">void</span> *data, <span class="keyword">const</span> <a class="code" href="struct__Eina__Value.html">Eina_Value</a> v, <span class="keyword">const</span> <a class="code" href="structEina__Future.html">Eina_Future</a> *dead_future)</div>
<div class="line">{</div>
<div class="line">   <a class="code" href="structEina__Promise.html">Eina_Promise</a> *p;</div>
<div class="line">   p = <a class="code" href="group__Eina__Promise.html#ga5ae6d1590598ba59014e00e4d5b85d82">eina_promise_continue_new</a>(dead_future, _promise_cancel, NULL);</div>
<div class="line">   <span class="keywordflow">return</span> <a class="code" href="group__Eina__Future.html#gab966fb4259f6c1d0f18840e31213a26a">eina_promise_as_value</a>(p);</div>
<div class="line">}</div>
<div class="ttc" id="agroup__Eina__Future_html_gab966fb4259f6c1d0f18840e31213a26a"><div class="ttname"><a href="group__Eina__Future.html#gab966fb4259f6c1d0f18840e31213a26a">eina_promise_as_value</a></div><div class="ttdeci">EINA_API Eina_Value eina_promise_as_value(Eina_Promise *p)</div><div class="ttdoc">Creates a new Eina_Value from a promise.</div><div class="ttdef"><b>Definition:</b> eina_promise.c:622</div></div>
<div class="ttc" id="agroup__Eina__Promise_html_ga5ae6d1590598ba59014e00e4d5b85d82"><div class="ttname"><a href="group__Eina__Promise.html#ga5ae6d1590598ba59014e00e4d5b85d82">eina_promise_continue_new</a></div><div class="ttdeci">EINA_API Eina_Promise * eina_promise_continue_new(const Eina_Future *dead_future, Eina_Promise_Cancel_Cb cancel_cb, const void *data)</div><div class="ttdoc">Creates a new promise from a dead_future.</div><div class="ttdef"><b>Definition:</b> eina_promise.c:762</div></div>
<div class="ttc" id="astructEina__Future_html"><div class="ttname"><a href="structEina__Future.html">Eina_Future</a></div><div class="ttdoc">An opaque structure representing a callback to be called when a promise is fulfilled.</div></div>
</div><!-- fragment --><p>If you already have a value and want to create a future that will resolve to it directly use the <a class="el" href="group__Eina__Future.html#ga09fbe25c39fe21ec2a8171b09330e0cd" title="Creates a new future that is already resolved to a value.">eina_future_resolved()</a>, it has the same effect as creating a promise and immediately resolving it.</p>
<dl class="section note"><dt>Note</dt><dd>This function is to be used solely inside of a future resolve callback with the <a class="el" href="group__Eina__Value__Group.html#ga7985e8af6e956ae31b381bf829173cc0" title="Store generic values.">Eina_Value</a> being returned from it.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">dead_future</td><td>The future being resolved to get a scheduler from. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cancel_cb</td><td>A callback used to inform that the promise was canceled. Use this callback to <code>free</code> <code>data</code>. <code>cancel_cb</code> must not be <code>NULL</code>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>Data to <code>cancel_cb</code>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A promise or <code>NULL</code> on error. </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__Eina__Future.html#ga5462a38eabc060b163d24c9d7395ae3b" title="Cancels a future.">eina_future_cancel()</a> </dd>
<dd>
<a class="el" href="group__Eina__Future.html#ga2a96213437a53d5fedd0fe57541d27b3" title="Creates a new future.">eina_future_new()</a> </dd>
<dd>
<a class="el" href="group__Eina__Promise.html#ga869bfac6443a0a0209057e87da1a79c5" title="Creates a new promise.">eina_promise_new()</a> </dd>
<dd>
<a class="el" href="group__Eina__Promise.html#ga231f1e09741f0cb0e9ceeef15cf4e4ee" title="Resolves a promise.">eina_promise_resolve()</a> </dd>
<dd>
<a class="el" href="group__Eina__Promise.html#ga33c04f489c071e795839cbf6e60566ba" title="Rejects a promise.">eina_promise_reject()</a> </dd>
<dd>
<a class="el" href="group__Eina__Future.html#gab966fb4259f6c1d0f18840e31213a26a" title="Creates a new Eina_Value from a promise.">eina_promise_as_value()</a> </dd>
<dd>
<a class="el" href="group__Eina__Future__Callbacks.html#ga190fb0e75b86d093db85b05abfd21ebd" title="Convenience wrapper over _Eina_Future_Scheduler.">Eina_Future_Scheduler</a> </dd>
<dd>
<a class="el" href="group__Eina__Future__Callbacks.html#ga8ecbf4d4816b354fad992cd5874c656a" title="Convenience wrapper over _Eina_Future_Schedule_Entry.">Eina_Future_Schedule_Entry</a> </dd>
<dd>
<a class="el" href="group__Eina__Future__Callbacks.html#gac685b488df7948131b6405451d0b4fb5" title="A callback used by the Eina_Future_Scheduler to deliver the future operation result.">Eina_Future_Scheduler_Cb</a> </dd></dl>

<p class="reference">References <a class="el" href="group__Eina__File__Group.html#gae8924623ca601364965e3d88fb7f40fa">DBG</a>, <a class="el" href="group__Eina__Memory__Pool__Group.html#gab9f29782c01cb62d2b70bc65c6fa5e1b">eina_mempool_calloc()</a>, <a class="el" href="group__Eina__Safety__Checks__Group.html#gab2b07061fc6500dedd9cd41c8d16f95d">EINA_SAFETY_ON_NULL_RETURN_VAL</a>, and <a class="el" href="group__Eina__Safety__Checks__Group.html#ga1dbe0d7e3c6b10f4bd49a2a132d73269">EINA_SAFETY_ON_TRUE_RETURN_VAL</a>.</p>

</div>
</div>
<a id="ga231f1e09741f0cb0e9ceeef15cf4e4ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga231f1e09741f0cb0e9ceeef15cf4e4ee">&#9670;&nbsp;</a></span>eina_promise_resolve()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__Eina__Types__Group.html#ga6ac08753ba12bc9c7a0390cf67868f4f">EINA_API</a> void eina_promise_resolve </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structEina__Promise.html">Eina_Promise</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__Eina__Value__Group.html#ga7985e8af6e956ae31b381bf829173cc0">Eina_Value</a>&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Resolves a promise. </p>
<p>This function schedules a resolve event in a safe context (main loop or some platform defined safe context), whenever possible the future callbacks will be dispatched.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">p</td><td>A promise to resolve. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">value</td><td>The value to be delivered.</td></tr>
  </table>
  </dd>
</dl>
<p>Note that the <code>value</code> contents must survive this function scope, that is, do <b>not</b> use stack allocated blobs, arrays, structures or types that keep references to memory you give. Values will be automatically cleaned up using <code><a class="el" href="group__Eina__Value__Value__Group.html#ga940660709a2862bafac92f47bb721a68" title="Empties a generic value storage.">eina_value_flush()</a></code> once they are unused (no more future or futures returned a new value).</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__Eina__Promise.html#ga869bfac6443a0a0209057e87da1a79c5" title="Creates a new promise.">eina_promise_new()</a> </dd>
<dd>
<a class="el" href="group__Eina__Promise.html#ga33c04f489c071e795839cbf6e60566ba" title="Rejects a promise.">eina_promise_reject()</a> </dd>
<dd>
<a class="el" href="group__Eina__Future.html#gab966fb4259f6c1d0f18840e31213a26a" title="Creates a new Eina_Value from a promise.">eina_promise_as_value()</a> </dd></dl>

<p class="reference">References <a class="el" href="group__Eina__Value__Value__Group.html#ga940660709a2862bafac92f47bb721a68">eina_value_flush()</a>.</p>

<p class="reference">Referenced by <a class="el" href="group__Eina__Future.html#ga09fbe25c39fe21ec2a8171b09330e0cd">eina_future_resolved()</a>.</p>

</div>
</div>
<a id="ga33c04f489c071e795839cbf6e60566ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga33c04f489c071e795839cbf6e60566ba">&#9670;&nbsp;</a></span>eina_promise_reject()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__Eina__Types__Group.html#ga6ac08753ba12bc9c7a0390cf67868f4f">EINA_API</a> void eina_promise_reject </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structEina__Promise.html">Eina_Promise</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__Eina__Error__Group.html#ga95b3cbb33e987e7d92a81ea785001686">Eina_Error</a>&#160;</td>
          <td class="paramname"><em>err</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rejects a promise. </p>
<p>This function schedules a reject event in a safe context (main loop or some platform defined safe context), whenever possible the future callbacks will be dispatched.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">p</td><td>A promise to reject. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">err</td><td>An Eina_Error value </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Internally this function will create an <a class="el" href="group__Eina__Value__Group.html#ga7985e8af6e956ae31b381bf829173cc0" title="Store generic values.">Eina_Value</a> with type <a class="el" href="group__Eina__Value__Group.html#ga49e7caa50355e2b1a2a4a0149c8e6aae" title="manages Eina_Error values.">EINA_VALUE_TYPE_ERROR</a>.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__Eina__Promise.html#ga869bfac6443a0a0209057e87da1a79c5" title="Creates a new promise.">eina_promise_new()</a> </dd>
<dd>
<a class="el" href="group__Eina__Promise.html#ga231f1e09741f0cb0e9ceeef15cf4e4ee" title="Resolves a promise.">eina_promise_resolve()</a> </dd>
<dd>
<a class="el" href="group__Eina__Future.html#gab966fb4259f6c1d0f18840e31213a26a" title="Creates a new Eina_Value from a promise.">eina_promise_as_value()</a> </dd></dl>

<p class="reference">References <a class="el" href="group__Eina__File__Group.html#gae8924623ca601364965e3d88fb7f40fa">DBG</a>, <a class="el" href="group__Eina__Error__Group.html#gaa92d19220b2c57d61be5e25db8257975">eina_error_msg_get()</a>, <a class="el" href="group__Eina__Safety__Checks__Group.html#gafa24bc421bcbbf70e5512619863fb3fc">EINA_SAFETY_ON_FALSE_GOTO</a>, <a class="el" href="group__Eina__Value__Value__Group.html#ga940660709a2862bafac92f47bb721a68">eina_value_flush()</a>, <a class="el" href="group__Eina__Value__Value__Group.html#ga9a1407c953694c3d6f40ab01ebe9a294">eina_value_set()</a>, <a class="el" href="group__Eina__Value__Value__Group.html#gab5c6558b1b8be2ad597d71a765cbf5f6">eina_value_setup()</a>, and <a class="el" href="group__Eina__Value__Group.html#ga28f6fb160baf3068e7c67ffba0a29c20">EINA_VALUE_TYPE_ERROR</a>.</p>

<p class="reference">Referenced by <a class="el" href="group__Eina__Future.html#ga6e03afecb9d4fa426cb6563805069818">eina_future_rejected()</a>.</p>

</div>
</div>
</div><!-- contents -->
<div class="footer">
  <p>
    <span class="version">EFL 1.26.99</span>
    <span class="copyright">Copyright &copy;2000-2022 <a href="http://www.enlightenment.org">enlightenment.org</a></span>
    <span class="generated">Generated @ Sat Oct 29 2022 18:10:54</span>
  </p>
</div>
</body>
</html>
