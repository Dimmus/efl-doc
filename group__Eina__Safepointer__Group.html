<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
"http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <title>Safe Pointer</title>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-110876574-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-110876574-1');
  </script>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <link rel="icon" href="favicon.png" type="image/x-icon">
  <link rel="shortcut icon" href="favicon.png" type="image/x-icon">
  <link rel="icon" href="favicon.png" type="image/ico">
  <link rel="shortcut icon" href="favicon.png" type="image/ico">
  <link rel="stylesheet" type="text/css" href="e.css">
</head>
<body>
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Safe Pointer<div class="ingroups"><a class="el" href="group__Eina.html">Eina</a> &raquo; <a class="el" href="group__Eina__Data__Types__Group.html">Data Types</a> &raquo; <a class="el" href="group__Eina__Containers__Group.html">Containers</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>These functions provide a wrapper that protect access to pointers.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:gaceb5489a49e4ff5eb71fe0e261707010"><td class="memItemLeft" align="right" valign="top"><a id="gaceb5489a49e4ff5eb71fe0e261707010"></a>
typedef struct _Eina_Safepointer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Eina__Safepointer__Group.html#gaceb5489a49e4ff5eb71fe0e261707010">Eina_Safepointer</a></td></tr>
<tr class="memdesc:gaceb5489a49e4ff5eb71fe0e261707010"><td class="mdescLeft">&#160;</td><td class="mdescRight">Type of the protected index. <br /></td></tr>
<tr class="separator:gaceb5489a49e4ff5eb71fe0e261707010"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga21a8566bb1c8ba357518d018ae622e13"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__Eina__Types__Group.html#ga6ac08753ba12bc9c7a0390cf67868f4f">EINA_API</a> const <a class="el" href="group__Eina__Safepointer__Group.html#gaceb5489a49e4ff5eb71fe0e261707010">Eina_Safepointer</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Eina__Safepointer__Group.html#ga21a8566bb1c8ba357518d018ae622e13">eina_safepointer_register</a> (const void *target)</td></tr>
<tr class="memdesc:ga21a8566bb1c8ba357518d018ae622e13"><td class="mdescLeft">&#160;</td><td class="mdescRight">Register a pointer and get an Eina_Safepointer that maps to it.  <a href="group__Eina__Safepointer__Group.html#ga21a8566bb1c8ba357518d018ae622e13">More...</a><br /></td></tr>
<tr class="separator:ga21a8566bb1c8ba357518d018ae622e13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf9ccfb391328af447306998be237cd57"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__Eina__Types__Group.html#ga6ac08753ba12bc9c7a0390cf67868f4f">EINA_API</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Eina__Safepointer__Group.html#gaf9ccfb391328af447306998be237cd57">eina_safepointer_unregister</a> (const <a class="el" href="group__Eina__Safepointer__Group.html#gaceb5489a49e4ff5eb71fe0e261707010">Eina_Safepointer</a> *safe)</td></tr>
<tr class="memdesc:gaf9ccfb391328af447306998be237cd57"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unregister an Eina_Safepointer and the pointer that maps to it.  <a href="group__Eina__Safepointer__Group.html#gaf9ccfb391328af447306998be237cd57">More...</a><br /></td></tr>
<tr class="separator:gaf9ccfb391328af447306998be237cd57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2202ee963589cf46aad92612e10c0533"><td class="memItemLeft" align="right" valign="top">static void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Eina__Safepointer__Group.html#ga2202ee963589cf46aad92612e10c0533">eina_safepointer_get</a> (const <a class="el" href="group__Eina__Safepointer__Group.html#gaceb5489a49e4ff5eb71fe0e261707010">Eina_Safepointer</a> *safe)</td></tr>
<tr class="memdesc:ga2202ee963589cf46aad92612e10c0533"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the associated pointer from an Eina_Safepointer mapping.  <a href="group__Eina__Safepointer__Group.html#ga2202ee963589cf46aad92612e10c0533">More...</a><br /></td></tr>
<tr class="separator:ga2202ee963589cf46aad92612e10c0533"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>These functions provide a wrapper that protect access to pointers. </p>
<p>Eina_Safepointer is an pointer to index converter that allows an increased level of safety by forbidding direct access to the pointer. The protection works by using a set of indirection tables that are mmapped and mprotected against write access. Thus the pointer they store and that map to a specific index is always correct. Also once a pointer is unregistered the index won't be served back for 2^8 on 32 bits system and 2^28 on 64 bits system for that specific slot. Finally we guarantee that the lower 2 bits of the returned index are actually never used and completely ignored by our API. So you can safely store whatever information you want in it, we will ignore it and treat as if it wasn't there.</p>
<dl class="section note"><dt>Note</dt><dd>The use of Eina_Safepointer is thread safe. </dd></dl>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga21a8566bb1c8ba357518d018ae622e13"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga21a8566bb1c8ba357518d018ae622e13">&#9670;&nbsp;</a></span>eina_safepointer_register()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__Eina__Types__Group.html#ga6ac08753ba12bc9c7a0390cf67868f4f">EINA_API</a> const <a class="el" href="group__Eina__Safepointer__Group.html#gaceb5489a49e4ff5eb71fe0e261707010">Eina_Safepointer</a>* eina_safepointer_register </td>
          <td>(</td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>target</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Register a pointer and get an Eina_Safepointer that maps to it. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">target</td><td>The pointer to register. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A valid pointer that is an index to the mapped pointer.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>It will return <code>NULL</code> on error or if <code>target</code> is <code>NULL</code>.</dd>
<dd>
The lower 2 bits of the returned pointer will always be 0.</dd>
<dd>
The returned pointer can be used like a pointer, but cannot be touched except with Eina_Safepointer functions.</dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.18 </dd></dl>

<p class="reference">References <a class="el" href="group__Eina__Lock__Group.html#ga7143ee35b9894e80578753485284256c">eina_spinlock_release()</a>, and <a class="el" href="group__Eina__Lock__Group.html#gaf9556624e5c6db1a66c20615c523efb5">eina_spinlock_take()</a>.</p>

</div>
</div>
<a id="gaf9ccfb391328af447306998be237cd57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf9ccfb391328af447306998be237cd57">&#9670;&nbsp;</a></span>eina_safepointer_unregister()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__Eina__Types__Group.html#ga6ac08753ba12bc9c7a0390cf67868f4f">EINA_API</a> void eina_safepointer_unregister </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="group__Eina__Safepointer__Group.html#gaceb5489a49e4ff5eb71fe0e261707010">Eina_Safepointer</a> *&#160;</td>
          <td class="paramname"><em>safe</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Unregister an Eina_Safepointer and the pointer that maps to it. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">safe</td><td>The index to unregister from the mapping.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This function will ignore the lower 2 bits of the given pointer.</dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.18 </dd></dl>

<p class="reference">References <a class="el" href="group__Eina__Lock__Group.html#ga7143ee35b9894e80578753485284256c">eina_spinlock_release()</a>, <a class="el" href="group__Eina__Lock__Group.html#gaf9556624e5c6db1a66c20615c523efb5">eina_spinlock_take()</a>, and <a class="el" href="group__Eina__Trash__Group.html#ga4187333fa1b6d28e1aad2e58bc059906">eina_trash_push()</a>.</p>

</div>
</div>
<a id="ga2202ee963589cf46aad92612e10c0533"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2202ee963589cf46aad92612e10c0533">&#9670;&nbsp;</a></span>eina_safepointer_get()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void* eina_safepointer_get </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="group__Eina__Safepointer__Group.html#gaceb5489a49e4ff5eb71fe0e261707010">Eina_Safepointer</a> *&#160;</td>
          <td class="paramname"><em>safe</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the associated pointer from an Eina_Safepointer mapping. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">safe</td><td>The Eina_Safepointer index to lookup at. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The pointer registered with that index or <code>NULL</code> in any other case.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>It is always safe to ask for a pointer for any value of the mapping. If the pointer is invalid or <code>NULL</code>, we will return <code>NULL</code> and not crash. </dd></dl>

</div>
</div>
</div><!-- contents -->
<div class="footer">
  <p>
    <span class="version">EFL 1.26.99</span>
    <span class="copyright">Copyright &copy;2000-2022 <a href="http://www.enlightenment.org">enlightenment.org</a></span>
    <span class="generated">Generated @ Sat Oct 29 2022 18:10:55</span>
  </p>
</div>
</body>
</html>
