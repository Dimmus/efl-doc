<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
"http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <title>Log Tutorial</title>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-110876574-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-110876574-1');
  </script>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <link rel="icon" href="favicon.png" type="image/x-icon">
  <link rel="shortcut icon" href="favicon.png" type="image/x-icon">
  <link rel="icon" href="favicon.png" type="image/ico">
  <link rel="shortcut icon" href="favicon.png" type="image/ico">
  <link rel="stylesheet" type="text/css" href="e.css">
</head>
<body>
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Log Tutorial </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="tutorial_log_introduction"></a>
Introduction</h1>
<p>The Eina Log module provides logging facilities for libraries and applications. It provides colored logging, basic logging levels (error, warning, debug, info, critical) and loggers - called logging domains - which will be covered in next sections.</p>
<h1><a class="anchor" id="tutorial_log_basic_usage"></a>
Basic Usage</h1>
<p>Log messages can be displayed using the following macros:</p>
<ul>
<li><a class="el" href="group__Eina__Log__Group.html#ga2e33caeeeb6051526c01b7fea4d6c91b" title="Logs a message with level ERROR on the default domain with the specified format.">EINA_LOG_ERR()</a>, </li>
<li><a class="el" href="group__Eina__Log__Group.html#gafb145e82df0f9441244832c94e87a21b" title="Logs a message with level INFO on the default domain with the specified format.">EINA_LOG_INFO()</a>, </li>
<li><a class="el" href="group__Eina__Log__Group.html#ga21c44f66537533db16ee8f475ae2ae70" title="Logs a message with level WARN on the default domain with the specified format.">EINA_LOG_WARN()</a>, </li>
<li><a class="el" href="group__Eina__Log__Group.html#ga09b88349373c2158f988d72375af5849" title="Logs a message with level DEBUG on the default domain with the specified format.">EINA_LOG_DBG()</a>.</li>
</ul>
<p>Here is an example:</p>
<div class="fragment"><div class="line"><span class="comment">//Compile with:</span></div>
<div class="line"><span class="comment">//gcc -Wall -o eina_log_02 eina_log_02.c `pkg-config --cflags --libs eina`</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="Eina_8h.html">Eina.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> test(<span class="keywordtype">int</span> i)</div>
<div class="line">{</div>
<div class="line">   <a class="code" href="group__Eina__Log__Group.html#ga09b88349373c2158f988d72375af5849">EINA_LOG_DBG</a>(<span class="stringliteral">&quot;Entering test&quot;</span>);</div>
<div class="line"> </div>
<div class="line">   <span class="keywordflow">if</span> (i &lt; 0)</div>
<div class="line">     {</div>
<div class="line">         <a class="code" href="group__Eina__Log__Group.html#ga2e33caeeeb6051526c01b7fea4d6c91b">EINA_LOG_ERR</a>(<span class="stringliteral">&quot;Argument is negative&quot;</span>);</div>
<div class="line">         <span class="keywordflow">return</span>;</div>
<div class="line">     }</div>
<div class="line"> </div>
<div class="line">   <a class="code" href="group__Eina__Log__Group.html#gafb145e82df0f9441244832c94e87a21b">EINA_LOG_INFO</a>(<span class="stringliteral">&quot;argument non negative&quot;</span>);</div>
<div class="line"> </div>
<div class="line">   <a class="code" href="group__Eina__Log__Group.html#ga09b88349373c2158f988d72375af5849">EINA_LOG_DBG</a>(<span class="stringliteral">&quot;Exiting test&quot;</span>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">   <span class="keywordflow">if</span> (!<a class="code" href="group__Eina__Main__Group.html#ga81b8137665b8a4d2cb38ca50017d4c74">eina_init</a>())</div>
<div class="line">     {</div>
<div class="line">         printf(<span class="stringliteral">&quot;log during the initialization of Eina_Log module\n&quot;</span>);</div>
<div class="line">         <span class="keywordflow">return</span> EXIT_FAILURE;</div>
<div class="line">     }</div>
<div class="line"> </div>
<div class="line">   <a class="code" href="group__Eina__Log__Group.html#ga1dc287505a8a9e4a4d6fa71994491b17">eina_log_level_set</a>(<a class="code" href="group__Eina__Log__Group.html#gga326699509b2e7578ace7c0a15b4a8c1aafdc5a5cfb78f5e4d5851447ed798af50">EINA_LOG_LEVEL_DBG</a>);</div>
<div class="line"> </div>
<div class="line">   test(-1);</div>
<div class="line">   test(0);</div>
<div class="line"> </div>
<div class="line">   <a class="code" href="group__Eina__Main__Group.html#ga5bf35513199d5220341437c05696285d">eina_shutdown</a>();</div>
<div class="line"> </div>
<div class="line">   <span class="keywordflow">return</span> EXIT_SUCCESS;</div>
<div class="line">}</div>
<div class="ttc" id="aEina_8h_html"><div class="ttname"><a href="Eina_8h.html">Eina.h</a></div><div class="ttdoc">Eina Utility library.</div></div>
<div class="ttc" id="agroup__Eina__Log__Group_html_ga09b88349373c2158f988d72375af5849"><div class="ttname"><a href="group__Eina__Log__Group.html#ga09b88349373c2158f988d72375af5849">EINA_LOG_DBG</a></div><div class="ttdeci">#define EINA_LOG_DBG(fmt,...)</div><div class="ttdoc">Logs a message with level DEBUG on the default domain with the specified format.</div><div class="ttdef"><b>Definition:</b> eina_log.h:400</div></div>
<div class="ttc" id="agroup__Eina__Log__Group_html_ga1dc287505a8a9e4a4d6fa71994491b17"><div class="ttname"><a href="group__Eina__Log__Group.html#ga1dc287505a8a9e4a4d6fa71994491b17">eina_log_level_set</a></div><div class="ttdeci">EINA_API void eina_log_level_set(int level)</div><div class="ttdoc">Sets the default log level.</div><div class="ttdef"><b>Definition:</b> eina_log.c:1733</div></div>
<div class="ttc" id="agroup__Eina__Log__Group_html_ga2e33caeeeb6051526c01b7fea4d6c91b"><div class="ttname"><a href="group__Eina__Log__Group.html#ga2e33caeeeb6051526c01b7fea4d6c91b">EINA_LOG_ERR</a></div><div class="ttdeci">#define EINA_LOG_ERR(fmt,...)</div><div class="ttdoc">Logs a message with level ERROR on the default domain with the specified format.</div><div class="ttdef"><b>Definition:</b> eina_log.h:376</div></div>
<div class="ttc" id="agroup__Eina__Log__Group_html_gafb145e82df0f9441244832c94e87a21b"><div class="ttname"><a href="group__Eina__Log__Group.html#gafb145e82df0f9441244832c94e87a21b">EINA_LOG_INFO</a></div><div class="ttdeci">#define EINA_LOG_INFO(fmt,...)</div><div class="ttdoc">Logs a message with level INFO on the default domain with the specified format.</div><div class="ttdef"><b>Definition:</b> eina_log.h:384</div></div>
<div class="ttc" id="agroup__Eina__Log__Group_html_gga326699509b2e7578ace7c0a15b4a8c1aafdc5a5cfb78f5e4d5851447ed798af50"><div class="ttname"><a href="group__Eina__Log__Group.html#gga326699509b2e7578ace7c0a15b4a8c1aafdc5a5cfb78f5e4d5851447ed798af50">EINA_LOG_LEVEL_DBG</a></div><div class="ttdeci">@ EINA_LOG_LEVEL_DBG</div><div class="ttdoc">Debug log level.</div><div class="ttdef"><b>Definition:</b> eina_log.h:461</div></div>
<div class="ttc" id="agroup__Eina__Main__Group_html_ga5bf35513199d5220341437c05696285d"><div class="ttname"><a href="group__Eina__Main__Group.html#ga5bf35513199d5220341437c05696285d">eina_shutdown</a></div><div class="ttdeci">EINA_API int eina_shutdown(void)</div><div class="ttdoc">Shuts down the Eina library.</div><div class="ttdef"><b>Definition:</b> eina_main.c:379</div></div>
<div class="ttc" id="agroup__Eina__Main__Group_html_ga81b8137665b8a4d2cb38ca50017d4c74"><div class="ttname"><a href="group__Eina__Main__Group.html#ga81b8137665b8a4d2cb38ca50017d4c74">eina_init</a></div><div class="ttdeci">EINA_API int eina_init(void)</div><div class="ttdoc">Initializes the Eina library.</div><div class="ttdef"><b>Definition:</b> eina_main.c:291</div></div>
</div><!-- fragment --><p>If you compiled Eina without debug mode, execution will yield only one log message, which is "argument is negative".</p>
<p>Here we introduce the concept of logging domains (or loggers), which might already be familiar to readers. It is basically a way to separate a set of log messages into a context (e.g. a module) and provide a way of controlling this set as a whole.</p>
<p>For example, suppose you have 3 different modules in your application and you want to get logging only from one of them (e.g. create some sort of filter). For achieving that, all you need to do is create a logging domain for each module so that all logging inside a module can be considered as a whole.</p>
<p>Logging domains are specified by a name, color applied to the name and the level. The first two (name and color) are set through code, that is, inside your application/module/library.</p>
<p>The level is used for controlling which messages should appear. It specifies the lowest level that should be displayed (e.g. a message with level 11 being logged on a domain with level set to 10 would be displayed, while a message with level 9 wouldn't).</p>
<p>The domain level is set during runtime (in contrast with the name and color) through the environment variable EINA_LOG_LEVELS. This variable expects a list in the form domain_name1:level1,domain_name2:level2,... . For example:</p>
<pre class="fragment">EINA_LOG_LEVELS=mymodule1:5,mymodule2:2,mymodule3:0 ./myapp</pre><p>This line would set mymodule1 level to 5, mymodule2 level to 2 and mymodule3 level to 0.</p>
<p>There's also a global logger to which EINA_LOG_(ERR, DBG, INFO, CRIT, WARN) macros do log on. It is a logger that is created internally by Eina Log with an empty name and can be used for general logging (where logging domains do not apply).</p>
<p>Since this global logger doesn't have a name, you can't set its level through EINA_LOG_LEVELS variable. Here we introduce a second environment variable that is a bit more special: EINA_LOG_LEVEL.</p>
<p>This variable specifies the level of the global logging domain and the level of domains that haven't been set through EINA_LOG_LEVELS. Here's an example:</p>
<pre class="fragment">EINA_LOG_LEVEL=3 EINA_LOG_LEVELS=module1:10,module3:2 ./myapp</pre><p>Supposing you have modules named "module1", "module2" and "module3", this line would result in module1 with level 10, module2 with level 3 and module3 with level 2. Note that module2's level wasn't specified, so it's level is set to the global level. This way we can easily apply filters to multiple domains with only one parameter (EINA_LOG_LEVEL=num).</p>
<p>The global level (EINA_LOG_LEVEL) can also be set through code, using <a class="el" href="group__Eina__Log__Group.html#ga1dc287505a8a9e4a4d6fa71994491b17" title="Sets the default log level.">eina_log_level_set()</a> function.</p>
<p>While developing your libraries or applications, you may notice that EINA_LOG_DOM_(ERR, DBG, INFO, CRIT, WARN) macros also print out messages from eina itself. Here we introduce another environment variable that is a bit more special: EINA_LOG_LEVELS_GLOB.</p>
<p>This variable allows you to disable the logging of any/all code in eina itself. This is useful when developing your libraries or applications so that you can see your own domain's messages easier without having to sift through a lot of internal eina debug messages. Here's an example:</p>
<pre class="fragment">EINA_LOG_LEVEL=3 EINA_LOG_LEVELS_GLOB=eina_*:0 ./myapp</pre><p>This will disable eina_log output from all internal eina code thus allowing you to see your own domain messages easier.</p>
<h1><a class="anchor" id="tutorial_log_advanced_display"></a>
Advanced usage of print callbacks</h1>
<p>The log module allows the user to change the way <a class="el" href="group__Eina__Log__Group.html#ga6d455dd27e2148919e225aec3a159c0c" title="Prints out log message using given domain and level.">eina_log_print()</a> displays the messages. It suffices to pass to <a class="el" href="group__Eina__Log__Group.html#ga163f303fe131ed5c15dc5754945d2f62" title="Sets logging method to use.">eina_log_print_cb_set()</a> the function used to display the message. That function must be of type <a class="el" href="group__Eina__Log__Group.html#ga76501a2d10e374980c4012664e4ca96f" title="Type for print callbacks.">Eina_Log_Print_Cb</a>. As a custom data can be passed to that callback, powerful display messages can be displayed.</p>
<p>It is suggested to not use <b>FILE</b>, <b>func</b> or <b>LINE</b> when writing that callback, but when defining macros (like <a class="el" href="group__Eina__Log__Group.html#ga2e33caeeeb6051526c01b7fea4d6c91b" title="Logs a message with level ERROR on the default domain with the specified format.">EINA_LOG_ERR()</a> and other macros).</p>
<p>Here is an example of custom callback, whose behavior can be changed at runtime:</p>
<div class="fragment"><div class="line"><span class="comment">//Compile with:</span></div>
<div class="line"><span class="comment">//gcc -Wall -o eina_log_03 eina_log_03.c `pkg-config --cflags --libs eina`</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="Eina_8h.html">Eina.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define log(fmt, ...)                                    \</span></div>
<div class="line"><span class="preprocessor">   eina_log_print(EINA_LOG_LEVEL_ERR, __FILE__, __func__, __LINE__, fmt, ##__VA_ARGS__)</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>_Data Data;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>_Data</div>
<div class="line">{</div>
<div class="line">   <span class="keywordtype">int</span> to_stderr;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> print_cb(<span class="keyword">const</span> <a class="code" href="struct__Eina__Log__Domain.html">Eina_Log_Domain</a> *domain,</div>
<div class="line">              <a class="code" href="group__Eina__Log__Group.html#ga5c0cd3a8463b76bb855805b70f58c7dd">Eina_Log_Level</a> level <a class="code" href="group__Eina__Types__Group.html#ga82d751be730f849719ca292f9558be87">EINA_UNUSED</a>,</div>
<div class="line">              <span class="keyword">const</span> <span class="keywordtype">char</span> *file,</div>
<div class="line">              <span class="keyword">const</span> <span class="keywordtype">char</span> *fnc,</div>
<div class="line">              <span class="keywordtype">int</span> line,</div>
<div class="line">              <span class="keyword">const</span> <span class="keywordtype">char</span> *fmt,</div>
<div class="line">              <span class="keywordtype">void</span> *data,</div>
<div class="line">              va_list args)</div>
<div class="line">{</div>
<div class="line">   Data *d;</div>
<div class="line">   FILE *output;</div>
<div class="line">   <span class="keywordtype">char</span> *str;</div>
<div class="line"> </div>
<div class="line">   d = (Data*)data;</div>
<div class="line">   <span class="keywordflow">if</span> (d-&gt;to_stderr)</div>
<div class="line">     {</div>
<div class="line">        output = stderr;</div>
<div class="line">        str = <span class="stringliteral">&quot;stderr&quot;</span>;</div>
<div class="line">    }</div>
<div class="line">   <span class="keywordflow">else</span></div>
<div class="line">     {</div>
<div class="line">       output = stdout;</div>
<div class="line">        str = <span class="stringliteral">&quot;stdout&quot;</span>;</div>
<div class="line">     }</div>
<div class="line"> </div>
<div class="line">   fprintf(output, <span class="stringliteral">&quot;%s:%s:%s (%d) %s: &quot;</span>,</div>
<div class="line">           domain-&gt;<a class="code" href="struct__Eina__Log__Domain.html#adac00ef51a0009e12583ca5932275f2e">domain_str</a>, file, fnc, line, str);</div>
<div class="line">   vfprintf(output, fmt, args);</div>
<div class="line">   putc(<span class="charliteral">&#39;\n&#39;</span>, output);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> test(Data *data, <span class="keywordtype">int</span> i)</div>
<div class="line">{</div>
<div class="line">   <span class="keywordflow">if</span> (i &lt; 0)</div>
<div class="line">      data-&gt;to_stderr = 0;</div>
<div class="line">   <span class="keywordflow">else</span></div>
<div class="line">      data-&gt;to_stderr = 1;</div>
<div class="line"> </div>
<div class="line">   <a class="code" href="group__Eina__Log__Group.html#gafb145e82df0f9441244832c94e87a21b">EINA_LOG_INFO</a>(<span class="stringliteral">&quot;Log message...&quot;</span>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">   Data data;</div>
<div class="line"> </div>
<div class="line">   <span class="keywordflow">if</span> (!<a class="code" href="group__Eina__Main__Group.html#ga81b8137665b8a4d2cb38ca50017d4c74">eina_init</a>())</div>
<div class="line">     {</div>
<div class="line">        printf(<span class="stringliteral">&quot;log during the initialization of Eina_Log module\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> EXIT_FAILURE;</div>
<div class="line">     }</div>
<div class="line"> </div>
<div class="line">   <a class="code" href="group__Eina__Log__Group.html#ga163f303fe131ed5c15dc5754945d2f62">eina_log_print_cb_set</a>(print_cb, &amp;data);</div>
<div class="line"> </div>
<div class="line">   test(&amp;data, -1);</div>
<div class="line">   test(&amp;data, 0);</div>
<div class="line"> </div>
<div class="line">   <a class="code" href="group__Eina__Main__Group.html#ga5bf35513199d5220341437c05696285d">eina_shutdown</a>();</div>
<div class="line"> </div>
<div class="line">   <span class="keywordflow">return</span> EXIT_SUCCESS;</div>
<div class="line">}</div>
<div class="ttc" id="agroup__Eina__Log__Group_html_ga163f303fe131ed5c15dc5754945d2f62"><div class="ttname"><a href="group__Eina__Log__Group.html#ga163f303fe131ed5c15dc5754945d2f62">eina_log_print_cb_set</a></div><div class="ttdeci">EINA_API void eina_log_print_cb_set(Eina_Log_Print_Cb cb, void *data)</div><div class="ttdoc">Sets logging method to use.</div><div class="ttdef"><b>Definition:</b> eina_log.c:1715</div></div>
<div class="ttc" id="agroup__Eina__Log__Group_html_ga5c0cd3a8463b76bb855805b70f58c7dd"><div class="ttname"><a href="group__Eina__Log__Group.html#ga5c0cd3a8463b76bb855805b70f58c7dd">Eina_Log_Level</a></div><div class="ttdeci">enum _Eina_Log_Level Eina_Log_Level</div><div class="ttdoc">List of available logging levels.</div></div>
<div class="ttc" id="agroup__Eina__Types__Group_html_ga82d751be730f849719ca292f9558be87"><div class="ttname"><a href="group__Eina__Types__Group.html#ga82d751be730f849719ca292f9558be87">EINA_UNUSED</a></div><div class="ttdeci">#define EINA_UNUSED</div><div class="ttdoc">Used to indicate that a function parameter is purposely unused.</div><div class="ttdef"><b>Definition:</b> eina_types.h:339</div></div>
<div class="ttc" id="astruct__Eina__Log__Domain_html"><div class="ttname"><a href="struct__Eina__Log__Domain.html">_Eina_Log_Domain</a></div><div class="ttdoc">The domain used for logging.</div><div class="ttdef"><b>Definition:</b> eina_log.h:414</div></div>
<div class="ttc" id="astruct__Eina__Log__Domain_html_adac00ef51a0009e12583ca5932275f2e"><div class="ttname"><a href="struct__Eina__Log__Domain.html#adac00ef51a0009e12583ca5932275f2e">_Eina_Log_Domain::domain_str</a></div><div class="ttdeci">const char * domain_str</div><div class="ttdoc">Formatted string with color to print.</div><div class="ttdef"><b>Definition:</b> eina_log.h:416</div></div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<div class="footer">
  <p>
    <span class="version">EFL 1.26.99</span>
    <span class="copyright">Copyright &copy;2000-2022 <a href="http://www.enlightenment.org">enlightenment.org</a></span>
    <span class="generated">Generated @ Sat Oct 29 2022 18:10:33</span>
  </p>
</div>
</body>
</html>
