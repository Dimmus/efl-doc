<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
"http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <title>Eina_Inlist advanced usage - lists and inlists</title>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-110876574-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-110876574-1');
  </script>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <link rel="icon" href="favicon.png" type="image/x-icon">
  <link rel="shortcut icon" href="favicon.png" type="image/x-icon">
  <link rel="icon" href="favicon.png" type="image/ico">
  <link rel="shortcut icon" href="favicon.png" type="image/ico">
  <link rel="stylesheet" type="text/css" href="e.css">
</head>
<body>
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Eina_Inlist advanced usage - lists and inlists </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p></p>
<p>This example describes the usage of <a class="el" href="group__Eina__Inline__List__Group.html#gad93973c87f867f249482e936797096ad">Eina_Inlist</a> mixed with <a class="el" href="group__Eina__List__Group.html#ga3295e1210efea1fb0fd6acbf3cbc1f29">Eina_List</a> . We create and add elements to an inlist, and the even members are also added to a normal list. Later we remove the elements divisible by 3 from this normal list.</p>
<p>The struct that is going to be used is the same used in <a class="el" href="eina_inlist_01_example_page.html">Eina_Inlist basic usage</a> , since we still need the <a class="el" href="group__Eina__Inline__List__Group.html#gab30a76fcfa50307c797491705d60136a">EINA_INLIST</a> macro to declare the inlist node info:</p>
<div class="fragment"><div class="line"><span class="keyword">struct </span>my_struct {</div>
<div class="line">     <a class="code" href="group__Eina__Inline__List__Group.html#gab30a76fcfa50307c797491705d60136a">EINA_INLIST</a>;</div>
<div class="line">     <span class="keywordtype">int</span> a, b;</div>
<div class="line">};</div>
<div class="ttc" id="agroup__Eina__Inline__List__Group_html_gab30a76fcfa50307c797491705d60136a"><div class="ttname"><a href="group__Eina__Inline__List__Group.html#gab30a76fcfa50307c797491705d60136a">EINA_INLIST</a></div><div class="ttdeci">#define EINA_INLIST</div><div class="ttdoc">Used for declaring an inlist member in a struct.</div><div class="ttdef"><b>Definition:</b> eina_inlist.h:411</div></div>
</div><!-- fragment --><p> The resulting node representing this struct can be exemplified by the following picture:</p>
<div class="image">
<img src="eina_inlist-node_eg2-my-struct.png" alt=""/>
</div>
  <p>Now we need some pointers and auxiliary variables that will help us iterate on the lists:</p>
<div class="fragment"><div class="line">   <span class="keyword">struct </span>my_struct *d, *cur;</div>
<div class="line">   <span class="keywordtype">int</span> i;</div>
<div class="line"> </div>
<div class="line">   <a class="code" href="struct__Eina__Inlist.html">Eina_Inlist</a> *inlist = NULL;</div>
<div class="line">   <a class="code" href="struct__Eina__List.html">Eina_List</a> *list = NULL, *l_itr, *l_next;</div>
<div class="ttc" id="astruct__Eina__Inlist_html"><div class="ttname"><a href="struct__Eina__Inlist.html">_Eina_Inlist</a></div><div class="ttdoc">Inlined list type.</div><div class="ttdef"><b>Definition:</b> eina_inlist.h:405</div></div>
<div class="ttc" id="astruct__Eina__List_html"><div class="ttname"><a href="struct__Eina__List.html">_Eina_List</a></div><div class="ttdoc">Type for a generic double linked list.</div><div class="ttdef"><b>Definition:</b> eina_list.h:318</div></div>
</div><!-- fragment --><p> Allocating 100 elements and putting them into an inlist, and the even elements also go to the normal list:</p>
<div class="fragment"><div class="line">   <span class="keywordflow">for</span> (i = 0; i &lt; 100; i++)</div>
<div class="line">     {</div>
<div class="line">        d = malloc(<span class="keyword">sizeof</span>(*d));</div>
<div class="line">        d-&gt;a = i;</div>
<div class="line">        d-&gt;b = i * 10;</div>
<div class="line">        inlist = <a class="code" href="group__Eina__Inline__List__Group.html#gaa33903d0ce018142df33b1e66b8f63d5">eina_inlist_append</a>(inlist, <a class="code" href="group__Eina__Inline__List__Group.html#ga5bc991428e75557c6195f6b9e38321fb">EINA_INLIST_GET</a>(d));</div>
<div class="line">        <span class="keywordflow">if</span> ((i % 2) == 0)</div>
<div class="line">          list = <a class="code" href="group__Eina__List__Group.html#gaa7f88be0b03dc813b3ff646608ff4614">eina_list_prepend</a>(list, d);</div>
<div class="line">     }</div>
<div class="ttc" id="agroup__Eina__Inline__List__Group_html_ga5bc991428e75557c6195f6b9e38321fb"><div class="ttname"><a href="group__Eina__Inline__List__Group.html#ga5bc991428e75557c6195f6b9e38321fb">EINA_INLIST_GET</a></div><div class="ttdeci">#define EINA_INLIST_GET(Inlist)</div><div class="ttdoc">Utility macro to get the inlist object of a struct.</div><div class="ttdef"><b>Definition:</b> eina_inlist.h:413</div></div>
<div class="ttc" id="agroup__Eina__Inline__List__Group_html_gaa33903d0ce018142df33b1e66b8f63d5"><div class="ttname"><a href="group__Eina__Inline__List__Group.html#gaa33903d0ce018142df33b1e66b8f63d5">eina_inlist_append</a></div><div class="ttdeci">EINA_API Eina_Inlist * eina_inlist_append(Eina_Inlist *list, Eina_Inlist *new_l)</div><div class="ttdoc">Adds a new node to end of a list.</div><div class="ttdef"><b>Definition:</b> eina_inlist.c:227</div></div>
<div class="ttc" id="agroup__Eina__List__Group_html_gaa7f88be0b03dc813b3ff646608ff4614"><div class="ttname"><a href="group__Eina__List__Group.html#gaa7f88be0b03dc813b3ff646608ff4614">eina_list_prepend</a></div><div class="ttdeci">EINA_API Eina_List * eina_list_prepend(Eina_List *list, const void *data)</div><div class="ttdoc">Prepends the given data to the given linked list.</div><div class="ttdef"><b>Definition:</b> eina_list.c:618</div></div>
</div><!-- fragment --><p> After this point, what we have are two distinct lists that share some elements. The first list (inlist) is defined by the pointers inside the elements data structure, while the second list (normal list) has its own node data structure that is kept outside of the elements.</p>
<p>The two lists, sharing some elements, can be represented by the following picture:</p>
 <div class="image">
<img src="eina_inlist-node_eg2-list-inlist.png" alt=""/>
</div>
 <p>Accessing both lists is done normally, as if they didn't have any elements in common:</p>
<div class="fragment"><div class="line">   printf(<span class="stringliteral">&quot;inlist=%p\n&quot;</span>, inlist);</div>
<div class="line">   <a class="code" href="group__Eina__Inline__List__Group.html#ga65e496b9b16d527d23c1d735652b4e62">EINA_INLIST_FOREACH</a>(inlist, cur)</div>
<div class="line">     printf(<span class="stringliteral">&quot;\ta=%d, b=%d\n&quot;</span>, cur-&gt;a, cur-&gt;b);</div>
<div class="line"> </div>
<div class="line">   printf(<span class="stringliteral">&quot;list=%p\n&quot;</span>, list);</div>
<div class="line">   <a class="code" href="group__Eina__List__Group.html#gac6efafc19f526d916cdb9757240a8773">EINA_LIST_FOREACH</a>(list, l_itr, cur)</div>
<div class="line">     printf(<span class="stringliteral">&quot;\ta=%d, b=%d\n&quot;</span>, cur-&gt;a, cur-&gt;b);</div>
<div class="line"> </div>
<div class="line">   printf(<span class="stringliteral">&quot;inlist count=%d\n&quot;</span>, <a class="code" href="group__Eina__Inline__List__Group.html#ga3039bdea008dcb10d52f648d154690f8">eina_inlist_count</a>(inlist));</div>
<div class="line">   printf(<span class="stringliteral">&quot;list count=%d\n\n&quot;</span>, <a class="code" href="group__Eina__List__Group.html#ga301729054a498a2df09a5f1dd760697e">eina_list_count</a>(list));</div>
<div class="ttc" id="agroup__Eina__Inline__List__Group_html_ga3039bdea008dcb10d52f648d154690f8"><div class="ttname"><a href="group__Eina__Inline__List__Group.html#ga3039bdea008dcb10d52f648d154690f8">eina_inlist_count</a></div><div class="ttdeci">EINA_API unsigned int eina_inlist_count(const Eina_Inlist *list)</div><div class="ttdoc">Gets the count of the number of items in a list.</div><div class="ttdef"><b>Definition:</b> eina_inlist.c:448</div></div>
<div class="ttc" id="agroup__Eina__Inline__List__Group_html_ga65e496b9b16d527d23c1d735652b4e62"><div class="ttname"><a href="group__Eina__Inline__List__Group.html#ga65e496b9b16d527d23c1d735652b4e62">EINA_INLIST_FOREACH</a></div><div class="ttdeci">#define EINA_INLIST_FOREACH(list, it)</div><div class="ttdef"><b>Definition:</b> eina_inlist.h:832</div></div>
<div class="ttc" id="agroup__Eina__List__Group_html_ga301729054a498a2df09a5f1dd760697e"><div class="ttname"><a href="group__Eina__List__Group.html#ga301729054a498a2df09a5f1dd760697e">eina_list_count</a></div><div class="ttdeci">static unsigned int eina_list_count(const Eina_List *list)</div><div class="ttdoc">Gets the count of the number of items in a list.</div></div>
<div class="ttc" id="agroup__Eina__List__Group_html_gac6efafc19f526d916cdb9757240a8773"><div class="ttname"><a href="group__Eina__List__Group.html#gac6efafc19f526d916cdb9757240a8773">EINA_LIST_FOREACH</a></div><div class="ttdeci">#define EINA_LIST_FOREACH(list, l, _data)</div><div class="ttdoc">Definition for the macro to iterate over a list.</div><div class="ttdef"><b>Definition:</b> eina_list.h:1415</div></div>
</div><!-- fragment --><p> We can remove elements from the normal list, but we just don't free them because they are still stored in the inlist:</p>
<div class="fragment"><div class="line">   <a class="code" href="group__Eina__List__Group.html#ga5b4d2aac696cd2558aaed03e3929d873">EINA_LIST_FOREACH_SAFE</a>(list, l_itr, l_next, cur)</div>
<div class="line">     {</div>
<div class="line">        <span class="keywordflow">if</span> ((cur-&gt;a % 3) == 0)</div>
<div class="line">          list = <a class="code" href="group__Eina__List__Group.html#ga6b43e977877db856175aa26dc2dc9c11">eina_list_remove_list</a>(list, l_itr);</div>
<div class="line">     }</div>
<div class="line"> </div>
<div class="line">   printf(<span class="stringliteral">&quot;inlist count=%d\n&quot;</span>, <a class="code" href="group__Eina__Inline__List__Group.html#ga3039bdea008dcb10d52f648d154690f8">eina_inlist_count</a>(inlist));</div>
<div class="line">   printf(<span class="stringliteral">&quot;list count=%d\n\n&quot;</span>, <a class="code" href="group__Eina__List__Group.html#ga301729054a498a2df09a5f1dd760697e">eina_list_count</a>(list));</div>
<div class="ttc" id="agroup__Eina__List__Group_html_ga5b4d2aac696cd2558aaed03e3929d873"><div class="ttname"><a href="group__Eina__List__Group.html#ga5b4d2aac696cd2558aaed03e3929d873">EINA_LIST_FOREACH_SAFE</a></div><div class="ttdeci">#define EINA_LIST_FOREACH_SAFE(list, l, l_next, data)</div><div class="ttdoc">Definition for the macro to iterate over a list with support for node deletion.</div><div class="ttdef"><b>Definition:</b> eina_list.h:1526</div></div>
<div class="ttc" id="agroup__Eina__List__Group_html_ga6b43e977877db856175aa26dc2dc9c11"><div class="ttname"><a href="group__Eina__List__Group.html#ga6b43e977877db856175aa26dc2dc9c11">eina_list_remove_list</a></div><div class="ttdeci">EINA_API Eina_List * eina_list_remove_list(Eina_List *list, Eina_List *remove_list)</div><div class="ttdoc">Removes the specified list node.</div><div class="ttdef"><b>Definition:</b> eina_list.c:786</div></div>
</div><!-- fragment --><p> To finish this example, we want to free both lists, we can't just free all elements on the second list (normal list) because they are still being used in the inlist. So we first discard the normal list without freeing its elements, then we free all elements in the inlist (that contains all elements allocated until now):</p>
<div class="fragment"><div class="line">   <a class="code" href="group__Eina__List__Group.html#ga2fe790d74d0efd278e3f4a1e11ab141d">eina_list_free</a>(list);</div>
<div class="line"> </div>
<div class="line">   <span class="keywordflow">while</span> (inlist)</div>
<div class="line">     {</div>
<div class="line">        <span class="keyword">struct </span>my_struct *aux = <a class="code" href="group__Eina__Inline__List__Group.html#ga8c4e6011e7caa9ec5c22b003c4950338">EINA_INLIST_CONTAINER_GET</a>(inlist,</div>
<div class="line">                                                          <span class="keyword">struct</span> my_struct);</div>
<div class="line">        inlist = <a class="code" href="group__Eina__Inline__List__Group.html#gac63799dc44bd71c21cb17bd951d7490b">eina_inlist_remove</a>(inlist, inlist);</div>
<div class="line">        free(aux);</div>
<div class="line">     }</div>
<div class="ttc" id="agroup__Eina__Inline__List__Group_html_ga8c4e6011e7caa9ec5c22b003c4950338"><div class="ttname"><a href="group__Eina__Inline__List__Group.html#ga8c4e6011e7caa9ec5c22b003c4950338">EINA_INLIST_CONTAINER_GET</a></div><div class="ttdeci">#define EINA_INLIST_CONTAINER_GET(ptr, type)</div><div class="ttdoc">Utility macro to get the container object of an inlist.</div><div class="ttdef"><b>Definition:</b> eina_inlist.h:415</div></div>
<div class="ttc" id="agroup__Eina__Inline__List__Group_html_gac63799dc44bd71c21cb17bd951d7490b"><div class="ttname"><a href="group__Eina__Inline__List__Group.html#gac63799dc44bd71c21cb17bd951d7490b">eina_inlist_remove</a></div><div class="ttdeci">EINA_API Eina_Inlist * eina_inlist_remove(Eina_Inlist *list, Eina_Inlist *item)</div><div class="ttdoc">Removes node from list.</div><div class="ttdef"><b>Definition:</b> eina_inlist.c:335</div></div>
<div class="ttc" id="agroup__Eina__List__Group_html_ga2fe790d74d0efd278e3f4a1e11ab141d"><div class="ttname"><a href="group__Eina__List__Group.html#ga2fe790d74d0efd278e3f4a1e11ab141d">eina_list_free</a></div><div class="ttdeci">EINA_API Eina_List * eina_list_free(Eina_List *list)</div><div class="ttdoc">Frees an entire list and all the nodes, ignoring the data contained.</div><div class="ttdef"><b>Definition:</b> eina_list.c:823</div></div>
</div><!-- fragment --><p> Here is the full source code for this example: <a class="el" href="eina_inlist_02_c.html">eina_inlist_02.c Eina_Inlist advanced usage - lists and inlists source</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<div class="footer">
  <p>
    <span class="version">EFL 1.26.99</span>
    <span class="copyright">Copyright &copy;2000-2022 <a href="http://www.enlightenment.org">enlightenment.org</a></span>
    <span class="generated">Generated @ Sat Oct 29 2022 18:10:32</span>
  </p>
</div>
</body>
</html>
