<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
"http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <title>EPhysics - Shapes</title>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-110876574-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-110876574-1');
  </script>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <link rel="icon" href="favicon.png" type="image/x-icon">
  <link rel="shortcut icon" href="favicon.png" type="image/x-icon">
  <link rel="icon" href="favicon.png" type="image/ico">
  <link rel="shortcut icon" href="favicon.png" type="image/ico">
  <link rel="stylesheet" type="text/css" href="e.css">
</head>
<body>
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">EPhysics - Shapes </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The purpose of this example is to demonstrate the EPhysics Shapes usage - The code creates two EPhysics_Bodys using a custom shape.</p>
<div class="image">
<img src="shapes.png" alt=""/>
</div>
 <p>For this example we'll have an EPhysics_World, and two basic EPhysics_Bodys.</p>
<p>The basic concepts like - defining an EPhysics_World, render geometry, physics limiting boundaries, add an EPhysics_Body, associate it to evas objects, change restitution, friction and impulse properties, were already covered in <a class="el" href="tutorial_ephysics_bouncing_ball.html">EPhysics - Bouncing Ball</a></p>
<h1><a class="anchor" id="add-shape"></a>
Adding a Shape</h1>
<p></p>
<p>Shapes are used to create bodies with shapes that differ from primitive ones, like box and circle.</p>
<p>A shape consists in a group of points, the vertices of the body to be created later with <a class="el" href="group__EPhysics__Body.html#gabe733ecf3e04d267005118ff7291daab" title="Create a new physics body using a custom shape.">ephysics_body_shape_add()</a>. You can also save and load it from a file.</p>
<p>We'll have to create a specific type of variable: <a class="el" href="group__EPhysics__Shape.html">EPhysics Shape</a></p>
<div class="fragment"><div class="line">_world_populate(Test_Data *test_data)</div>
<div class="line">{</div>
<div class="line">   <a class="code" href="group__EPhysics__Shape.html#gadfcc565af1b4e898f2959292a9089e7e">EPhysics_Shape</a> *pentagon_shape, *hexagon_shape;</div>
<div class="line">   <a class="code" href="group__EPhysics__Body.html#gaf39ad724f8a2f81f9139c63263900bf1">EPhysics_Body</a> *pentagon_body, *hexagon_body;</div>
<div class="line">   <a class="code" href="group__Evas__Object__Group.html#ga9e19e6dd1f517a0ba437c0114d3e7c97">Evas_Object</a> *pentagon, *hexagon;</div>
<div class="ttc" id="agroup__EPhysics__Body_html_gaf39ad724f8a2f81f9139c63263900bf1"><div class="ttname"><a href="group__EPhysics__Body.html#gaf39ad724f8a2f81f9139c63263900bf1">EPhysics_Body</a></div><div class="ttdeci">struct _EPhysics_Body EPhysics_Body</div><div class="ttdoc">Body handle, represents an object on EPhysics world.</div><div class="ttdef"><b>Definition:</b> EPhysics.h:655</div></div>
<div class="ttc" id="agroup__EPhysics__Shape_html_gadfcc565af1b4e898f2959292a9089e7e"><div class="ttname"><a href="group__EPhysics__Shape.html#gadfcc565af1b4e898f2959292a9089e7e">EPhysics_Shape</a></div><div class="ttdeci">struct _EPhysics_Shape EPhysics_Shape</div><div class="ttdoc">Shape handle, represents a shape to be used to create a body.</div><div class="ttdef"><b>Definition:</b> EPhysics.h:507</div></div>
<div class="ttc" id="agroup__Evas__Object__Group_html_ga9e19e6dd1f517a0ba437c0114d3e7c97"><div class="ttname"><a href="group__Evas__Object__Group.html#ga9e19e6dd1f517a0ba437c0114d3e7c97">Evas_Object</a></div><div class="ttdeci">Efl_Canvas_Object Evas_Object</div><div class="ttdoc">An Evas Object handle.</div><div class="ttdef"><b>Definition:</b> Evas_Common.h:185</div></div>
</div><!-- fragment --><p> First we add an image we want to add an EPhysics_Body to have a reference to after set the points (vertices).</p>
<div class="fragment"><div class="line">   pentagon = <a class="code" href="group__Elm__Image.html#ga5d211c8af4f6e297a24fc4e8737c81a9">elm_image_add</a>(test_data-&gt;win);</div>
<div class="line">   <a class="code" href="group__Elm__Image.html#gad1a96ede5f513042cef3c1dac4572f73">elm_image_file_set</a>(</div>
<div class="line">      pentagon, PACKAGE_DATA_DIR <span class="stringliteral">&quot;/&quot;</span> EPHYSICS_TEST_THEME <span class="stringliteral">&quot;.edj&quot;</span>, <span class="stringliteral">&quot;pentagon&quot;</span>);</div>
<div class="line">   <a class="code" href="group__Evas__Object__Group.html#ga335c8ee6eaeaac9710656af4f8b0db91">evas_object_move</a>(pentagon, WIDTH / 3, HEIGHT / 2 - 80);</div>
<div class="line">   <a class="code" href="group__Evas__Object__Group.html#gacad94595f83580c18908cb3b69b08d1a">evas_object_resize</a>(pentagon, 70, 68);</div>
<div class="line">   <a class="code" href="group__Evas__Object__Group__Basic.html#ga07208fcafd4739de606bc35fff684bf5">evas_object_show</a>(pentagon);</div>
<div class="ttc" id="agroup__Elm__Image_html_ga5d211c8af4f6e297a24fc4e8737c81a9"><div class="ttname"><a href="group__Elm__Image.html#ga5d211c8af4f6e297a24fc4e8737c81a9">elm_image_add</a></div><div class="ttdeci">Evas_Object * elm_image_add(Evas_Object *parent)</div><div class="ttdoc">Add a new image to the parent.</div><div class="ttdef"><b>Definition:</b> efl_ui_image.c:2735</div></div>
<div class="ttc" id="agroup__Elm__Image_html_gad1a96ede5f513042cef3c1dac4572f73"><div class="ttname"><a href="group__Elm__Image.html#gad1a96ede5f513042cef3c1dac4572f73">elm_image_file_set</a></div><div class="ttdeci">Eina_Bool elm_image_file_set(Evas_Object *obj, const char *file, const char *group)</div><div class="ttdoc">Set the file that will be used as the image's source.</div><div class="ttdef"><b>Definition:</b> efl_ui_image.c:2435</div></div>
<div class="ttc" id="agroup__Evas__Object__Group__Basic_html_ga07208fcafd4739de606bc35fff684bf5"><div class="ttname"><a href="group__Evas__Object__Group__Basic.html#ga07208fcafd4739de606bc35fff684bf5">evas_object_show</a></div><div class="ttdeci">EVAS_API void evas_object_show(Evas_Object *eo_obj)</div><div class="ttdoc">Makes the given Evas object visible.</div><div class="ttdef"><b>Definition:</b> evas_object_main.c:1814</div></div>
<div class="ttc" id="agroup__Evas__Object__Group_html_ga335c8ee6eaeaac9710656af4f8b0db91"><div class="ttname"><a href="group__Evas__Object__Group.html#ga335c8ee6eaeaac9710656af4f8b0db91">evas_object_move</a></div><div class="ttdeci">EVAS_API void evas_object_move(Evas_Object *obj, Evas_Coord x, Evas_Coord y)</div><div class="ttdoc">Move the given Evas object to the given location inside its canvas' viewport.</div><div class="ttdef"><b>Definition:</b> evas_object_main.c:1171</div></div>
<div class="ttc" id="agroup__Evas__Object__Group_html_gacad94595f83580c18908cb3b69b08d1a"><div class="ttname"><a href="group__Evas__Object__Group.html#gacad94595f83580c18908cb3b69b08d1a">evas_object_resize</a></div><div class="ttdeci">EVAS_API void evas_object_resize(Evas_Object *obj, Evas_Coord w, Evas_Coord h)</div><div class="ttdoc">Changes the size of the given Evas object.</div><div class="ttdef"><b>Definition:</b> evas_object_main.c:1236</div></div>
</div><!-- fragment --><p> Here we create a new shape, note that the returned shape initially doesn't has points set, so its requiered to set vertices.</p>
<div class="fragment"><div class="line">   pentagon_shape = <a class="code" href="group__EPhysics__Shape.html#ga79ca252f9b15296416c3f73c75efa293">ephysics_shape_new</a>();</div>
<div class="ttc" id="agroup__EPhysics__Shape_html_ga79ca252f9b15296416c3f73c75efa293"><div class="ttname"><a href="group__EPhysics__Shape.html#ga79ca252f9b15296416c3f73c75efa293">ephysics_shape_new</a></div><div class="ttdeci">EAPI EPhysics_Shape * ephysics_shape_new(void)</div><div class="ttdoc">Create a new shape.</div></div>
</div><!-- fragment --><p> Now we're setting the shape points (vertices) basing on the image that we added, two vertices form a link between them, an edge, so with some vertices is possible to create polygons, in this case a pentagon.</p>
<div class="fragment"><div class="line">   <a class="code" href="group__EPhysics__Shape.html#ga2548c7a3aaf658b9be6132f60c1b3948">ephysics_shape_point_add</a>(pentagon_shape, -1, -9/33., -1);</div>
<div class="line">   <a class="code" href="group__EPhysics__Shape.html#ga2548c7a3aaf658b9be6132f60c1b3948">ephysics_shape_point_add</a>(pentagon_shape, -1, -9/33., 1);</div>
<div class="line">   <a class="code" href="group__EPhysics__Shape.html#ga2548c7a3aaf658b9be6132f60c1b3948">ephysics_shape_point_add</a>(pentagon_shape, 0, -1, -1);</div>
<div class="line">   <a class="code" href="group__EPhysics__Shape.html#ga2548c7a3aaf658b9be6132f60c1b3948">ephysics_shape_point_add</a>(pentagon_shape, 0, -1, 1);</div>
<div class="line">   <a class="code" href="group__EPhysics__Shape.html#ga2548c7a3aaf658b9be6132f60c1b3948">ephysics_shape_point_add</a>(pentagon_shape, 1, -9/33., -1);</div>
<div class="line">   <a class="code" href="group__EPhysics__Shape.html#ga2548c7a3aaf658b9be6132f60c1b3948">ephysics_shape_point_add</a>(pentagon_shape, 1, -9/33., 1);</div>
<div class="line">   <a class="code" href="group__EPhysics__Shape.html#ga2548c7a3aaf658b9be6132f60c1b3948">ephysics_shape_point_add</a>(pentagon_shape, -21/35., 1, -1);</div>
<div class="line">   <a class="code" href="group__EPhysics__Shape.html#ga2548c7a3aaf658b9be6132f60c1b3948">ephysics_shape_point_add</a>(pentagon_shape, -21/35., 1, 1);</div>
<div class="line">   <a class="code" href="group__EPhysics__Shape.html#ga2548c7a3aaf658b9be6132f60c1b3948">ephysics_shape_point_add</a>(pentagon_shape, 21/35., 1, -1);</div>
<div class="line">   <a class="code" href="group__EPhysics__Shape.html#ga2548c7a3aaf658b9be6132f60c1b3948">ephysics_shape_point_add</a>(pentagon_shape, 21/35., 1, 1);</div>
<div class="ttc" id="agroup__EPhysics__Shape_html_ga2548c7a3aaf658b9be6132f60c1b3948"><div class="ttname"><a href="group__EPhysics__Shape.html#ga2548c7a3aaf658b9be6132f60c1b3948">ephysics_shape_point_add</a></div><div class="ttdeci">EAPI Eina_Bool ephysics_shape_point_add(EPhysics_Shape *shape, double x, double y, double z)</div><div class="ttdoc">Add a new point to the shape.</div></div>
</div><!-- fragment --><p> Here we create a new physics body using a custom shape. The center of mass will be the center of the shape. Its collision shape will be the convex shape that has all the points (and edges) we added to this shape before.</p>
<div class="fragment"><div class="line">   pentagon_body = <a class="code" href="group__EPhysics__Body.html#gabe733ecf3e04d267005118ff7291daab">ephysics_body_shape_add</a>(test_data-&gt;world, pentagon_shape);</div>
<div class="line">   <a class="code" href="group__EPhysics__Body.html#ga39cb9e95bbe1d097926a09365c501db3">ephysics_body_evas_object_set</a>(pentagon_body, pentagon, <a class="code" href="group__Eina__Types__Group.html#ga05c12dacc8b4058994df842b41be85fc">EINA_TRUE</a>);</div>
<div class="line">   <a class="code" href="group__EPhysics__Body.html#ga731c9a6443f7c4294fce23fc1287b778">ephysics_body_restitution_set</a>(pentagon_body, 1);</div>
<div class="ttc" id="agroup__EPhysics__Body_html_ga39cb9e95bbe1d097926a09365c501db3"><div class="ttname"><a href="group__EPhysics__Body.html#ga39cb9e95bbe1d097926a09365c501db3">ephysics_body_evas_object_set</a></div><div class="ttdeci">EAPI void ephysics_body_evas_object_set(EPhysics_Body *body, Evas_Object *evas_obj, Eina_Bool use_obj_pos)</div><div class="ttdoc">Set an evas object to a physics body.</div></div>
<div class="ttc" id="agroup__EPhysics__Body_html_ga731c9a6443f7c4294fce23fc1287b778"><div class="ttname"><a href="group__EPhysics__Body.html#ga731c9a6443f7c4294fce23fc1287b778">ephysics_body_restitution_set</a></div><div class="ttdeci">EAPI void ephysics_body_restitution_set(EPhysics_Body *body, double restitution)</div><div class="ttdoc">Set body's coefficient of restitution.</div></div>
<div class="ttc" id="agroup__EPhysics__Body_html_gabe733ecf3e04d267005118ff7291daab"><div class="ttname"><a href="group__EPhysics__Body.html#gabe733ecf3e04d267005118ff7291daab">ephysics_body_shape_add</a></div><div class="ttdeci">EAPI EPhysics_Body * ephysics_body_shape_add(EPhysics_World *world, EPhysics_Shape *shape)</div><div class="ttdoc">Create a new physics body using a custom shape.</div></div>
<div class="ttc" id="agroup__Eina__Types__Group_html_ga05c12dacc8b4058994df842b41be85fc"><div class="ttname"><a href="group__Eina__Types__Group.html#ga05c12dacc8b4058994df842b41be85fc">EINA_TRUE</a></div><div class="ttdeci">#define EINA_TRUE</div><div class="ttdoc">boolean value TRUE (numerical value 1)</div><div class="ttdef"><b>Definition:</b> eina_types.h:539</div></div>
</div><!-- fragment --><p> Here we just delete the custom shape (not the body) after used to create the wanted bodies, it's required to delete it. It won't be deleted automatically by ephysics at any point, even on shutdown.</p>
<div class="fragment"><div class="line">   <a class="code" href="group__EPhysics__Shape.html#ga9d91574e5cdac7772d6c75c22c32d8a7">ephysics_shape_del</a>(pentagon_shape);</div>
<div class="ttc" id="agroup__EPhysics__Shape_html_ga9d91574e5cdac7772d6c75c22c32d8a7"><div class="ttname"><a href="group__EPhysics__Shape.html#ga9d91574e5cdac7772d6c75c22c32d8a7">ephysics_shape_del</a></div><div class="ttdeci">EAPI void ephysics_shape_del(EPhysics_Shape *shape)</div><div class="ttdoc">Delete a shape.</div></div>
</div><!-- fragment --><p> In the example we add another shape with the same process we just used, but with different image and points.</p>
<p></p>
<div class="fragment"><div class="line">   <a class="code" href="group__EPhysics__Shape.html#ga2548c7a3aaf658b9be6132f60c1b3948">ephysics_shape_point_add</a>(hexagon_shape, 0, 30, -10);</div>
<div class="line">   <a class="code" href="group__EPhysics__Shape.html#ga2548c7a3aaf658b9be6132f60c1b3948">ephysics_shape_point_add</a>(hexagon_shape, 0, 30, 10);</div>
<div class="line">   <a class="code" href="group__EPhysics__Shape.html#ga2548c7a3aaf658b9be6132f60c1b3948">ephysics_shape_point_add</a>(hexagon_shape, 18, 0, -10);</div>
<div class="line">   <a class="code" href="group__EPhysics__Shape.html#ga2548c7a3aaf658b9be6132f60c1b3948">ephysics_shape_point_add</a>(hexagon_shape, 18, 0, 10);</div>
<div class="line">   <a class="code" href="group__EPhysics__Shape.html#ga2548c7a3aaf658b9be6132f60c1b3948">ephysics_shape_point_add</a>(hexagon_shape, 52, 0, -10);</div>
<div class="line">   <a class="code" href="group__EPhysics__Shape.html#ga2548c7a3aaf658b9be6132f60c1b3948">ephysics_shape_point_add</a>(hexagon_shape, 52, 0, 10);</div>
<div class="line">   <a class="code" href="group__EPhysics__Shape.html#ga2548c7a3aaf658b9be6132f60c1b3948">ephysics_shape_point_add</a>(hexagon_shape, 70, 30, -10);</div>
<div class="line">   <a class="code" href="group__EPhysics__Shape.html#ga2548c7a3aaf658b9be6132f60c1b3948">ephysics_shape_point_add</a>(hexagon_shape, 70, 30, 10);</div>
<div class="line">   <a class="code" href="group__EPhysics__Shape.html#ga2548c7a3aaf658b9be6132f60c1b3948">ephysics_shape_point_add</a>(hexagon_shape, 52, 60, -10);</div>
<div class="line">   <a class="code" href="group__EPhysics__Shape.html#ga2548c7a3aaf658b9be6132f60c1b3948">ephysics_shape_point_add</a>(hexagon_shape, 52, 60, 10);</div>
<div class="line">   <a class="code" href="group__EPhysics__Shape.html#ga2548c7a3aaf658b9be6132f60c1b3948">ephysics_shape_point_add</a>(hexagon_shape, 18, 60, -10);</div>
<div class="line">   <a class="code" href="group__EPhysics__Shape.html#ga2548c7a3aaf658b9be6132f60c1b3948">ephysics_shape_point_add</a>(hexagon_shape, 18, 60, 10);</div>
</div><!-- fragment --><p> Here we finish the example. The full source code can be found at <a class="el" href="test_shapes_c.html">test_shapes.c</a>. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<div class="footer">
  <p>
    <span class="version">EFL 1.26.99</span>
    <span class="copyright">Copyright &copy;2000-2022 <a href="http://www.enlightenment.org">enlightenment.org</a></span>
    <span class="generated">Generated @ Sat Oct 29 2022 18:10:40</span>
  </p>
</div>
</body>
</html>
